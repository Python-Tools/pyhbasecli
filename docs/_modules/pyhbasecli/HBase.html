

<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>pyhbasecli.HBase &mdash; pyhbasecli 0.0.2 文档</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/translations.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="搜索" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> pyhbasecli
          

          
          </a>

          
            
            
              <div class="version">
                0.0.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="在文档中搜索" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../README.html">介绍</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html">0.0.2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html#id2">0.0.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../autoapi/index.html">API Reference</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">pyhbasecli</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">模块代码</a> &raquo;</li>
        
          <li><a href="../pyhbasecli.html">pyhbasecli</a> &raquo;</li>
        
      <li>pyhbasecli.HBase</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>pyhbasecli.HBase 源代码</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;hbase客户端封装.</span>

<span class="sd">主要解决易用性问题:</span>
<span class="sd">1. 让客户端不需要导入thrift定义的类.</span>
<span class="sd">2. 让客户端不用显式的传输bytes类型的参数.</span>
<span class="sd">3. 让客户端可以使用事先设定好的编码解码函数直接沟通python和hbase</span>

<span class="sd">使用方法:</span>

<span class="sd">    with HBaseCli(</span>
<span class="sd">                url=&quot;http://ld-bp17y8n3j6f45p944-proxy-hbaseue.hbaseue.rds.aliyuncs.com:9190&quot;,</span>
<span class="sd">                headers={&quot;ACCESSKEYID&quot;: &quot;root&quot;, &quot;ACCESSSIGNATURE&quot;: &quot;root&quot;}) as client:</span>
<span class="sd">        nsinfo = client.show_namespaces()</span>
<span class="sd">    print(nsinfo)</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">binascii</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Tuple</span>
<span class="kn">from</span> <span class="nn">thrift.protocol</span> <span class="kn">import</span> <span class="n">TBinaryProtocol</span>
<span class="kn">from</span> <span class="nn">thrift.transport</span> <span class="kn">import</span> <span class="n">THttpClient</span>

<span class="kn">from</span> <span class="nn">.hbase</span> <span class="kn">import</span> <span class="n">THBaseService</span>
<span class="kn">from</span> <span class="nn">.hbase.ttypes</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">TColumn</span><span class="p">,</span>
    <span class="n">TColumnFamilyDescriptor</span><span class="p">,</span>
    <span class="n">TColumnValue</span><span class="p">,</span>
    <span class="n">TGet</span><span class="p">,</span>
    <span class="n">TDelete</span><span class="p">,</span>
    <span class="n">TCellVisibility</span><span class="p">,</span>
    <span class="n">TNamespaceDescriptor</span><span class="p">,</span>
    <span class="n">TPut</span><span class="p">,</span>
    <span class="n">TAppend</span><span class="p">,</span>
    <span class="n">TIncrement</span><span class="p">,</span>
    <span class="n">TScan</span><span class="p">,</span>
    <span class="n">TTableDescriptor</span><span class="p">,</span>
    <span class="n">TTableName</span><span class="p">,</span>
    <span class="n">TDurability</span><span class="p">,</span>
    <span class="n">TBloomFilterType</span><span class="p">,</span>
    <span class="n">TCompressionAlgorithm</span><span class="p">,</span>
    <span class="n">TDataBlockEncoding</span><span class="p">,</span>
    <span class="n">TKeepDeletedCells</span><span class="p">,</span>
    <span class="n">TTimeRange</span><span class="p">,</span>
    <span class="n">TAuthorization</span><span class="p">,</span>
    <span class="n">TConsistency</span><span class="p">,</span>
    <span class="n">TDeleteType</span><span class="p">,</span>
    <span class="n">TReadType</span><span class="p">,</span>
    <span class="n">TColumnIncrement</span><span class="p">,</span>
    <span class="n">TCompareOp</span><span class="p">,</span>
    <span class="n">TMutation</span><span class="p">,</span>
    <span class="n">TRowMutations</span>
<span class="p">)</span>


<span class="k">def</span> <span class="nf">fullcolumn</span><span class="p">(</span><span class="n">family</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">column</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;构造列完整名.</span>

<span class="sd">    Args:</span>
<span class="sd">        family (str): 列簇名</span>
<span class="sd">        column (str): 列名</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: 列完整名</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">family</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s2">&quot;</span>


<div class="viewcode-block" id="newTColumnValue"><a class="viewcode-back" href="../../autoapi/pyhbasecli/index.html#pyhbasecli.newTColumnValue">[文档]</a><span class="k">def</span> <span class="nf">newTColumnValue</span><span class="p">(</span><span class="n">column</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value_bytes</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">family</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">tags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">type_</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TColumnValue</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;创建一个可用于代理的TColumnValue对象.</span>

<span class="sd">    Args:</span>
<span class="sd">        column (str): 列名,列名中如果是&quot;family:column&quot;的形式即为列全名,即已经指定了列簇则可以不填family参数</span>
<span class="sd">        family (Optional[str]): 列簇名</span>
<span class="sd">        value_bytes (bytes): 列的值</span>
<span class="sd">        timestamp (Optional[datetime.datetime], optional): 时间. Defaults to None.</span>
<span class="sd">        tags (Optional[str], optional): 标签. Defaults to None.</span>
<span class="sd">        type_ (Optional[str], optional): type值. Defaults to None.</span>

<span class="sd">    Raises:</span>
<span class="sd">        AttributeError: 列名格式不合法</span>

<span class="sd">    Returns:</span>
<span class="sd">        TColumnValue: 列结果对象</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">family</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">_family</span> <span class="o">=</span> <span class="n">family</span>
        <span class="n">_column</span> <span class="o">=</span> <span class="n">column</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">columninfo</span> <span class="o">=</span> <span class="n">column</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">columninfo</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">_family</span> <span class="o">=</span> <span class="n">columninfo</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">_column</span> <span class="o">=</span> <span class="n">columninfo</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;parameter column syntax error: </span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">_tags</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">tags</span><span class="p">:</span>
        <span class="n">_tags</span> <span class="o">=</span> <span class="n">tags</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
    <span class="n">_type</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">type_</span><span class="p">:</span>
        <span class="n">_type</span> <span class="o">=</span> <span class="n">type_</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>

    <span class="n">_timestamp</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">timestamp</span><span class="p">:</span>
        <span class="n">_timestamp</span> <span class="o">=</span> <span class="n">timestamp</span><span class="o">.</span><span class="n">timestamp</span><span class="p">()</span>
        <span class="n">_timestamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">_timestamp</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">TColumnValue</span><span class="p">(</span>
        <span class="n">family</span><span class="o">=</span><span class="n">_family</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">),</span>
        <span class="n">qualifier</span><span class="o">=</span><span class="n">_column</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">),</span>
        <span class="n">value</span><span class="o">=</span><span class="n">value_bytes</span><span class="p">,</span>
        <span class="n">timestamp</span><span class="o">=</span><span class="n">_timestamp</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="n">_tags</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="n">_type</span><span class="p">)</span></div>


<div class="viewcode-block" id="ColumnsValue"><a class="viewcode-back" href="../../autoapi/pyhbasecli/index.html#pyhbasecli.ColumnsValue">[文档]</a><span class="k">class</span> <span class="nc">ColumnsValue</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;TColumnValue的代理类.&quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;instance&#39;</span><span class="p">,</span> <span class="s2">&quot;_encoder&quot;</span><span class="p">,</span> <span class="s2">&quot;_decoder&quot;</span><span class="p">)</span>
    <span class="n">instance</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">TColumnValue</span><span class="p">]</span>
    <span class="n">_encoder</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="nb">bytes</span><span class="p">]]</span>
    <span class="n">_decoder</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="nb">bytes</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]],</span> <span class="n">Any</span><span class="p">]]</span>

    <span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">instance</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s1">&#39;Cannot use uninitialized Proxy.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">instance</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">attr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__slots__</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s1">&#39;Cannot set attribute on proxy.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_value</span><span class="p">(</span><span class="n">clz</span><span class="p">,</span>
                   <span class="n">family</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">column</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">encoder</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="nb">bytes</span><span class="p">],</span>
                   <span class="n">timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">tags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">type_</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;ColumnsValue&#39;</span><span class="p">:</span>

        <span class="n">p</span> <span class="o">=</span> <span class="n">clz</span><span class="p">(</span><span class="n">encoder</span><span class="o">=</span><span class="n">encoder</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">initialize_from_value</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="n">family</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="n">column</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">,</span> <span class="n">timestamp</span><span class="o">=</span><span class="n">timestamp</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="n">tags</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="n">type_</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">p</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">encoder</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="nb">bytes</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">decoder</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="nb">bytes</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]],</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;创建一个TColumnValue的代理对象</span>

<span class="sd">        Args:</span>
<span class="sd">            encoder (Optional[Callable[[Any, Optional[str]], bytes]]): 将值编码为bytes的函数,可选项str会在调用时传入tags的值,方便一些场景根据tag判断编码方法</span>
<span class="sd">            decoder (Optional[Callable[[bytes, Optional[bytes]], Any]]): 将bytes编码为值的函数,可选项str会在调用时传入tags的值,方便一些场景根据tag判断编码方法</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">instance</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">encoder</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_encoder</span> <span class="o">=</span> <span class="n">encoder</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_encoder</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">decoder</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_decoder</span> <span class="o">=</span> <span class="n">decoder</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_decoder</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">regist_decoder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">decoder</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">bytes</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]],</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;为代理对象注册解码器.</span>

<span class="sd">        Args:</span>
<span class="sd">            decoder (Callable[[bytes, Optional[bytes]], Any]): 将bytes编码为值的函数,可选项str会在调用时传入tags的值,方便一些场景根据tag判断编码方法</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_decoder</span> <span class="o">=</span> <span class="n">decoder</span>

    <span class="k">def</span> <span class="nf">regist_encoder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">encoder</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="nb">bytes</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;为代理对象注册编码器.</span>

<span class="sd">        Args:</span>
<span class="sd">            encoder (Callable[[Any, Optional[str]], bytes]): 将值编码为bytes的函数,可选项str会在调用时传入tags的值,方便一些场景根据tag判断编码方法</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_encoder</span> <span class="o">=</span> <span class="n">encoder</span>

    <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance</span><span class="p">:</span> <span class="n">TColumnValue</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;将被代理的实例注册到代理上.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">TColumnValue</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">instance</span> <span class="o">=</span> <span class="n">instance</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;instance is not TColumnValue&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">initialize_from_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">family</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">column</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">tags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">type_</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;创建一个新的TColumnValue对象并使用本对象进行代理.</span>

<span class="sd">        Args:</span>
<span class="sd">            column (str): 列名,列名中如果是&quot;family:column&quot;的形式即为列全名,即已经指定了列簇则可以不填family参数</span>
<span class="sd">            family (Optional[str]): 列簇名</span>
<span class="sd">            value_bytes (bytes): 列的值</span>
<span class="sd">            timestamp (Optional[datetime.datetime], optional): 时间. Defaults to None.</span>
<span class="sd">            tags (Optional[str], optional): 标签. Defaults to None.</span>
<span class="sd">            type_ (Optional[str], optional): type值. Defaults to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_encoder</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;need to set encoder first&quot;</span><span class="p">)</span>
        <span class="n">value_bytes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_encoder</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">tags</span><span class="p">)</span>
        <span class="n">instance</span> <span class="o">=</span> <span class="n">newTColumnValue</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="n">family</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="n">column</span><span class="p">,</span> <span class="n">value_bytes</span><span class="o">=</span><span class="n">value_bytes</span><span class="p">,</span> <span class="n">timestamp</span><span class="o">=</span><span class="n">timestamp</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="n">tags</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="n">type_</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;获取ColumnsValue的信息字典.</span>

<span class="sd">        该信息字典可以被`newTColumnValue`函数用于创建一个TColumnValue.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict[str, Union[int, str, bytes]]: 信息字典</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">instance</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;not initialize yet&quot;</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;column&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">instance</span><span class="o">.</span><span class="n">qualifier</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">),</span>
            <span class="s2">&quot;family&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">instance</span><span class="o">.</span><span class="n">family</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">),</span>
            <span class="s2">&quot;value_bytes&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">instance</span><span class="o">.</span><span class="n">value</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">instance</span><span class="o">.</span><span class="n">timestamp</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
                <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">instance</span><span class="o">.</span><span class="n">timestamp</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)</span>
            <span class="p">})</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">instance</span><span class="o">.</span><span class="n">tags</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
                <span class="s2">&quot;tags&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">instance</span><span class="o">.</span><span class="n">tags</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
            <span class="p">})</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">instance</span><span class="o">.</span><span class="n">type</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
                <span class="s2">&quot;type_&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">instance</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
            <span class="p">})</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;获取python可以直接处理的键值对.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Tuple[str, Any]: python可以直接处理的键值对,键为列全名,值为列的值.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">instance</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;not initialize yet&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_decoder</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;need to set decoder first&quot;</span><span class="p">)</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">fullcolumn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">instance</span><span class="o">.</span><span class="n">family</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">instance</span><span class="o">.</span><span class="n">qualifier</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_decoder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">instance</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">instance</span><span class="o">.</span><span class="n">tags</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">as_TColumnValue</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TColumnValue</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;提取代理的TColumnValue对象.</span>

<span class="sd">        Returns:</span>
<span class="sd">            TColumnValue: 代理对象内代理的TColumnValue对象</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">instance</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;not initialize yet&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">instance</span></div>


<div class="viewcode-block" id="StrEncoder"><a class="viewcode-back" href="../../autoapi/pyhbasecli/index.html#pyhbasecli.StrEncoder">[文档]</a><span class="k">def</span> <span class="nf">StrEncoder</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;字符串编码器.</span>

<span class="sd">    将python对象的字面量编码为字节流.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (Any): python对象</span>
<span class="sd">        y (Optional[str]): 无用占位</span>

<span class="sd">    Returns:</span>
<span class="sd">        bytes: 编码后的结果</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="StrDecoder"><a class="viewcode-back" href="../../autoapi/pyhbasecli/index.html#pyhbasecli.StrDecoder">[文档]</a><span class="k">def</span> <span class="nf">StrDecoder</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;字符串解码器.</span>

<span class="sd">    将字节流解码为将python字符串.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (bytes): 待解码字节流</span>
<span class="sd">        y (Optional[bytes]): 无用占位</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: 字符串</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="JsonEncoder"><a class="viewcode-back" href="../../autoapi/pyhbasecli/index.html#pyhbasecli.JsonEncoder">[文档]</a><span class="k">def</span> <span class="nf">JsonEncoder</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;json编码器.</span>

<span class="sd">    将python对象用json编码为字节流.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (Any): python对象</span>
<span class="sd">        y (Optional[str]): 无用占位</span>

<span class="sd">    Returns:</span>
<span class="sd">        bytes: 编码后的结果</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="JsonDecoder"><a class="viewcode-back" href="../../autoapi/pyhbasecli/index.html#pyhbasecli.JsonDecoder">[文档]</a><span class="k">def</span> <span class="nf">JsonDecoder</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;json解码器.</span>

<span class="sd">    将字节流解码为将python字符串.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (bytes): 待解码字节流</span>
<span class="sd">        y (Optional[bytes]): 无用占位</span>

<span class="sd">    Returns:</span>
<span class="sd">        Any: python对象</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span></div>


<div class="viewcode-block" id="NumberDecoder"><a class="viewcode-back" href="../../autoapi/pyhbasecli/index.html#pyhbasecli.NumberDecoder">[文档]</a><span class="k">def</span> <span class="nf">NumberDecoder</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;将bytes转化为int型数据.</span>

<span class="sd">    用于获取incr操作列中的当前值.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (bytes): 待解码字节流</span>
<span class="sd">        y (bytes): 无用占位</span>

<span class="sd">    Returns:</span>
<span class="sd">        int: 当前值</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">binascii</span><span class="o">.</span><span class="n">b2a_hex</span><span class="p">(</span><span class="n">x</span><span class="p">))[</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">16</span><span class="p">)</span></div>


<span class="k">def</span> <span class="nf">_createClosestRowAfter</span><span class="p">(</span><span class="n">row</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;找到比当前row大的最小row.</span>
<span class="sd">    方法是在当前row后加入一个0x00的byte,从比当前row大的最小row开始scan.可以保证中间不会漏扫描数据.</span>

<span class="sd">    Args:</span>
<span class="sd">        row (bytes): 当前row</span>

<span class="sd">    Returns:</span>
<span class="sd">        bytes: 比当前row大的最小row</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">array</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
    <span class="n">array</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mh">0x00</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">MutationStatus</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="n">PREPAREING</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">SUBMIT</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">CHECK_FAILED</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">ERROR</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">SUCCESS</span> <span class="o">=</span> <span class="mi">5</span>


<span class="k">class</span> <span class="nc">ResubmitException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="MutationSession"><a class="viewcode-back" href="../../autoapi/pyhbasecli/index.html#pyhbasecli.MutationSession">[文档]</a><span class="k">class</span> <span class="nc">MutationSession</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">cli</span><span class="p">:</span> <span class="s1">&#39;HBaseCli&#39;</span><span class="p">,</span>
                 <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">row</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                 <span class="n">ns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">check_row</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">check_column_full_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">check_compare_op</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">check_column_value</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;创建一个mutation会话.</span>

<span class="sd">        Args:</span>
<span class="sd">            cli (HBaseCli): 客户端对象.</span>
<span class="sd">            table (str): 指定会话指向的表,表名中如果是&quot;ns:table&quot;的形式已经指定了命名空间则可以不填ns参数</span>
<span class="sd">            row (str): 指向会话指向的行</span>
<span class="sd">            ns (Optional[str], optional): 命名空间. Defaults to None.</span>
<span class="sd">            check_row (Optional[str], optional): 待监测行名</span>
<span class="sd">            check_column_full_name (Optional[str], optional): 待检查的列,以`列簇:列名`形式表示,如果有指定`column_value`则检查指定列的值是否和`column_value`指定的相同,否则检查指定列是否存在.</span>
<span class="sd">            check_column_value (Optional[bytes], optional): 指定检查列的值与之执行对比操作的值.</span>
<span class="sd">            check_compare_op (Optional[str], optional): 指定对比操作,可选的有LESS,LESS_OR_EQUAL,EQUAL,NOT_EQUAL,GREATER_OR_EQUAL,GREATER,NO_OP. Defaults to None.</span>

<span class="sd">        Raises:</span>
<span class="sd">            AttributeError: 表名格式不合法</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">ns</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tableNameInbytes</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ns</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tabelinfo</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tabelinfo</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">tableNameInbytes</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;parameter table syntax error: </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cli</span> <span class="o">=</span> <span class="n">cli</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table</span> <span class="o">=</span> <span class="n">tableNameInbytes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">row</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_row</span> <span class="o">=</span> <span class="n">check_row</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">check_row</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">check_column_full_name</span><span class="p">:</span>
            <span class="n">check_family</span><span class="p">,</span> <span class="n">check_col</span> <span class="o">=</span> <span class="n">check_column_full_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">check_family</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]</span> <span class="o">=</span> <span class="n">check_family</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">check_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]</span> <span class="o">=</span> <span class="n">check_col</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">check_family</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">check_col</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_compare_op</span> <span class="o">=</span> <span class="n">TCompareOp</span><span class="o">.</span><span class="n">_NAMES_TO_VALUES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">check_compare_op</span><span class="p">)</span> <span class="k">if</span> <span class="n">check_compare_op</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_column_value</span> <span class="o">=</span> <span class="n">check_column_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutations</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">TMutation</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mutation_status</span> <span class="o">=</span> <span class="n">MutationStatus</span><span class="o">.</span><span class="n">PREPAREING</span>

    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;MutationSession&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">exc_value</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">traceback</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">submit</span><span class="p">()</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">status</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MutationStatus</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;mutation会话的状态.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mutation_status</span>

    <span class="k">def</span> <span class="nf">submit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;提交mutation会话.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mutation_status</span> <span class="o">!=</span> <span class="n">MutationStatus</span><span class="o">.</span><span class="n">PREPAREING</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ResubmitException</span><span class="p">(</span><span class="s2">&quot;can not resubmit&quot;</span><span class="p">)</span>
        <span class="n">trm</span> <span class="o">=</span> <span class="n">TRowMutations</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row</span><span class="p">,</span> <span class="n">mutations</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mutations</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mutation_status</span> <span class="o">=</span> <span class="n">MutationStatus</span><span class="o">.</span><span class="n">SUBMIT</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">all</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">check_row</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_family</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_col</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_compare_op</span><span class="p">]):</span>
                <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cli</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">checkAndMutate</span><span class="p">(</span>
                    <span class="n">table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">,</span>
                    <span class="n">row</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">check_row</span><span class="p">,</span>
                    <span class="n">family</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">check_family</span><span class="p">,</span>
                    <span class="n">qualifier</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">check_col</span><span class="p">,</span>
                    <span class="n">compareOp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">check_compare_op</span><span class="p">,</span>
                    <span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">check_column_value</span><span class="p">,</span>
                    <span class="n">rowMutations</span><span class="o">=</span><span class="n">trm</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="n">r</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_mutation_status</span> <span class="o">=</span> <span class="n">MutationStatus</span><span class="o">.</span><span class="n">SUCCESS</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_mutation_status</span> <span class="o">=</span> <span class="n">MutationStatus</span><span class="o">.</span><span class="n">CHECK_FAILED</span>
                <span class="k">return</span> <span class="n">r</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cli</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">mutateRow</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">,</span> <span class="n">trowMutations</span><span class="o">=</span><span class="n">trm</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_mutation_status</span> <span class="o">=</span> <span class="n">MutationStatus</span><span class="o">.</span><span class="n">SUCCESS</span>
                <span class="k">return</span> <span class="kc">True</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_mutation_status</span> <span class="o">=</span> <span class="n">MutationStatus</span><span class="o">.</span><span class="n">ERROR</span>
            <span class="k">raise</span> <span class="n">e</span>

    <span class="k">def</span> <span class="nf">add_put</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kvs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">ColumnsValue</span><span class="p">],</span> <span class="o">*</span><span class="p">,</span> <span class="n">row</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">attributes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">durability</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">cellVisibility</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,)</span> <span class="o">-&gt;</span> <span class="s1">&#39;MutationSession&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;添加修改操作</span>

<span class="sd">        Args:</span>
<span class="sd">            kvs (List[ColumnsValue]): kvs (List[ColumnsValue]): 传入的值序列</span>
<span class="sd">            row (Optional[str], optional): 行名,如果不填则使用默认行. Defaults to None.</span>
<span class="sd">            timestamp (Optional[datetime.datetime], optional): 指定时间戳. Defaults to None.</span>
<span class="sd">            attributes (Optional[Dict[str, bytes]], optional): 指定属性. Defaults to None.</span>
<span class="sd">            durability (Optional[str], optional): 指定耐久方式设置,可选的有USE_DEFAULT,SKIP_WAL,ASYNC_WAL,SYNC_WAL,FSYNC_WAL.Defaults to None.</span>
<span class="sd">            cellVisibility (Optional[str], optional): cell的可视性设置. Defaults to None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            MutationSession: _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mutation_status</span> <span class="o">!=</span> <span class="n">MutationStatus</span><span class="o">.</span><span class="n">PREPAREING</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ResubmitException</span><span class="p">(</span><span class="s2">&quot;can not add mutation to a submited session&quot;</span><span class="p">)</span>
        <span class="n">_timestamp</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">timestamp</span><span class="p">:</span>
            <span class="n">_timestamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">timestamp</span><span class="o">.</span><span class="n">timestamp</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>
        <span class="n">_attributes</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">attributes</span><span class="p">:</span>
            <span class="n">_attributes</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">):</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">attributes</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
        <span class="n">_durability</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">durability</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_durability</span> <span class="o">=</span> <span class="n">TDurability</span><span class="o">.</span><span class="n">_NAMES_TO_VALUES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">durability</span><span class="p">)</span>
        <span class="n">_cellVisibility</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">cellVisibility</span><span class="p">:</span>
            <span class="n">_cellVisibility</span> <span class="o">=</span> <span class="n">TCellVisibility</span><span class="p">(</span><span class="n">expression</span><span class="o">=</span><span class="n">cellVisibility</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">row</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">TMutation</span><span class="p">(</span>
                <span class="n">put</span><span class="o">=</span><span class="n">TPut</span><span class="p">(</span>
                    <span class="n">row</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row</span><span class="p">,</span>
                    <span class="n">columnValues</span><span class="o">=</span><span class="p">[</span><span class="n">kv</span><span class="o">.</span><span class="n">as_TColumnValue</span><span class="p">()</span> <span class="k">for</span> <span class="n">kv</span> <span class="ow">in</span> <span class="n">kvs</span><span class="p">],</span>
                    <span class="n">timestamp</span><span class="o">=</span><span class="n">_timestamp</span><span class="p">,</span>
                    <span class="n">attributes</span><span class="o">=</span><span class="n">_attributes</span><span class="p">,</span>
                    <span class="n">durability</span><span class="o">=</span><span class="n">_durability</span><span class="p">,</span>
                    <span class="n">cellVisibility</span><span class="o">=</span><span class="n">_cellVisibility</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">TMutation</span><span class="p">(</span>
                <span class="n">put</span><span class="o">=</span><span class="n">TPut</span><span class="p">(</span>
                    <span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">),</span>
                    <span class="n">columnValues</span><span class="o">=</span><span class="p">[</span><span class="n">kv</span><span class="o">.</span><span class="n">as_TColumnValue</span><span class="p">()</span> <span class="k">for</span> <span class="n">kv</span> <span class="ow">in</span> <span class="n">kvs</span><span class="p">],</span>
                    <span class="n">timestamp</span><span class="o">=</span><span class="n">_timestamp</span><span class="p">,</span>
                    <span class="n">attributes</span><span class="o">=</span><span class="n">_attributes</span><span class="p">,</span>
                    <span class="n">durability</span><span class="o">=</span><span class="n">_durability</span><span class="p">,</span>
                    <span class="n">cellVisibility</span><span class="o">=</span><span class="n">_cellVisibility</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">add_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                   <span class="n">row</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                   <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                   <span class="n">timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                   <span class="n">deleteType</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                   <span class="n">attributes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                   <span class="n">durability</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,)</span> <span class="o">-&gt;</span> <span class="s1">&#39;MutationSession&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;增加删除行为.</span>

<span class="sd">        Args:</span>
<span class="sd">            row (Optional[str], optional): 指定要删除数据的行,如果不指定则使用默认行. Defaults to None.</span>
<span class="sd">            columns (Optional[Sequence[str]], optional): 指定要删除的列信息,以&quot;列簇:列名&quot;的形式表达. Defaults to None.</span>
<span class="sd">            timestamp (Optional[datetime.datetime], optional): 指定时间戳. Defaults to None.</span>
<span class="sd">            deleteType (Optional[str], optional): 指定删除类型,可选为DELETE_COLUMN-删除指定列,DELETE_COLUMNS-删除所有列,DELETE_FAMILY-删除指定列簇,DELETE_FAMILY_VERSION-删除指定列簇的指定版本. Defaults to DELETE_COLUMNS.</span>
<span class="sd">            attributes (Optional[Dict[str, bytes]], optional): 指定属性. Defaults to None.</span>
<span class="sd">            durability (Optional[str], optional): 指定耐久方式设置,可选的有USE_DEFAULT,SKIP_WAL,ASYNC_WAL,SYNC_WAL,FSYNC_WAL.Defaults to None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            MutationSession: _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mutation_status</span> <span class="o">!=</span> <span class="n">MutationStatus</span><span class="o">.</span><span class="n">PREPAREING</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ResubmitException</span><span class="p">(</span><span class="s2">&quot;can not add mutation to a submited session&quot;</span><span class="p">)</span>
        <span class="n">_columns</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">columns</span><span class="p">:</span>
            <span class="n">_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">TColumn</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">qualifier</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">else</span> <span class="n">TColumn</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">]</span>
        <span class="n">_timestamp</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">timestamp</span><span class="p">:</span>
            <span class="n">_timestamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">timestamp</span><span class="o">.</span><span class="n">timestamp</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>
        <span class="n">_deleteType</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">deleteType</span><span class="p">:</span>
            <span class="n">_deleteType</span> <span class="o">=</span> <span class="n">TDeleteType</span><span class="o">.</span><span class="n">_NAMES_TO_VALUES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">deleteType</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">_attributes</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">attributes</span><span class="p">:</span>
            <span class="n">_attributes</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">):</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">attributes</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
        <span class="n">_durability</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">durability</span><span class="p">:</span>
            <span class="n">_durability</span> <span class="o">=</span> <span class="n">TDurability</span><span class="o">.</span><span class="n">_NAMES_TO_VALUES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">durability</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">row</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">TMutation</span><span class="p">(</span><span class="n">deleteSingle</span><span class="o">=</span><span class="n">TDelete</span><span class="p">(</span>
                <span class="n">row</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row</span><span class="p">,</span>
                <span class="n">columns</span><span class="o">=</span><span class="n">_columns</span><span class="p">,</span>
                <span class="n">timestamp</span><span class="o">=</span><span class="n">_timestamp</span><span class="p">,</span>
                <span class="n">deleteType</span><span class="o">=</span><span class="n">_deleteType</span><span class="p">,</span>
                <span class="n">attributes</span><span class="o">=</span><span class="n">_attributes</span><span class="p">,</span>
                <span class="n">durability</span><span class="o">=</span><span class="n">_durability</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">TMutation</span><span class="p">(</span><span class="n">deleteSingle</span><span class="o">=</span><span class="n">TDelete</span><span class="p">(</span>
                <span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">),</span>
                <span class="n">columns</span><span class="o">=</span><span class="n">_columns</span><span class="p">,</span>
                <span class="n">timestamp</span><span class="o">=</span><span class="n">_timestamp</span><span class="p">,</span>
                <span class="n">deleteType</span><span class="o">=</span><span class="n">_deleteType</span><span class="p">,</span>
                <span class="n">attributes</span><span class="o">=</span><span class="n">_attributes</span><span class="p">,</span>
                <span class="n">durability</span><span class="o">=</span><span class="n">_durability</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>


<div class="viewcode-block" id="HBaseCli"><a class="viewcode-back" href="../../autoapi/pyhbasecli/index.html#pyhbasecli.HBaseCli">[文档]</a><span class="k">class</span> <span class="nc">HBaseCli</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">headers</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;连接hbase.</span>

<span class="sd">        Example:</span>
<span class="sd">            client = HBaseCli(</span>
<span class="sd">                url=&quot;http://ld-bp17y8n3j6f45p944-proxy-hbaseue.hbaseue.rds.aliyuncs.com:9190&quot;,</span>
<span class="sd">                headers={&quot;ACCESSKEYID&quot;: &quot;root&quot;, &quot;ACCESSSIGNATURE&quot;: &quot;root&quot;})</span>

<span class="sd">        Args:</span>
<span class="sd">            url (string): 连接的路径</span>
<span class="sd">            headers (Optional[Mapping[str, str]]): 设置请求头,有验证的话用户名设置ACCESSKEYID,密码设置ACCESSSIGNATURE</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">transport</span> <span class="o">=</span> <span class="n">THttpClient</span><span class="o">.</span><span class="n">THttpClient</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">setCustomHeaders</span><span class="p">(</span><span class="n">headers</span><span class="p">)</span>
            <span class="n">protocol</span> <span class="o">=</span> <span class="n">TBinaryProtocol</span><span class="o">.</span><span class="n">TBinaryProtocolAccelerated</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="n">THBaseService</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">protocol</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">e</span>

    <span class="k">def</span> <span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transport</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;HBaseCli&#39;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">exc_value</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">traceback</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="c1"># 命名空间操作</span>
    <span class="k">def</span> <span class="nf">create_namespace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ns</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">configs</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; 创建命名空间.</span>

<span class="sd">        Args:</span>
<span class="sd">            ns (string): 命名空间名称</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">createNamespace</span><span class="p">(</span><span class="n">TNamespaceDescriptor</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">ns</span><span class="p">,</span> <span class="n">configuration</span><span class="o">=</span><span class="n">configs</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">delete_namespace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ns</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;删除命名空间.</span>

<span class="sd">        Args:</span>
<span class="sd">            ns (str): 命名空间名</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">deleteNamespace</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">desc_namespace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ns</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;查看指定命名空间的信息.</span>

<span class="sd">        Args:</span>
<span class="sd">            ns (str): 命名空间名</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict[str, str]: 命名空间信息</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Descriptor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">getNamespaceDescriptor</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">Descriptor</span><span class="o">.</span><span class="n">name</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">Descriptor</span><span class="o">.</span><span class="n">configuration</span><span class="p">:</span>
            <span class="n">temp</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">Descriptor</span><span class="o">.</span><span class="n">configuration</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">temp</span>

    <span class="k">def</span> <span class="nf">show_namespaces</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;列出已有的命名空间.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List[Dict[str, str]]: 命名空间列表</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Descriptors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">listNamespaceDescriptors</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">Descriptor</span> <span class="ow">in</span> <span class="n">Descriptors</span><span class="p">:</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">Descriptor</span><span class="o">.</span><span class="n">name</span><span class="p">}</span>
            <span class="k">if</span> <span class="n">Descriptor</span><span class="o">.</span><span class="n">configuration</span><span class="p">:</span>
                <span class="n">temp</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">Descriptor</span><span class="o">.</span><span class="n">configuration</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">show_tables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ns</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;查看指定namespace下的表信息.</span>

<span class="sd">        Args:</span>
<span class="sd">            ns (str): 命名空间名称</span>

<span class="sd">        Returns:</span>
<span class="sd">            List[Dict[str, str]]: _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">TableDescriptors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">getTableDescriptorsByNamespace</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">TableDescriptor</span> <span class="ow">in</span> <span class="n">TableDescriptors</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">TableDescriptor</span><span class="o">.</span><span class="n">durability</span><span class="p">:</span>
                <span class="n">durability</span> <span class="o">=</span> <span class="n">TableDescriptor</span><span class="o">.</span><span class="n">durability</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">durability</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">if</span> <span class="n">TableDescriptor</span><span class="o">.</span><span class="n">tableName</span><span class="p">:</span>
                <span class="n">tn</span> <span class="o">=</span> <span class="n">TableDescriptor</span><span class="o">.</span><span class="n">tableName</span>
                <span class="n">nsn</span> <span class="o">=</span> <span class="n">tn</span><span class="o">.</span><span class="n">ns</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf - 8&quot;</span><span class="p">)</span>
                <span class="n">t</span> <span class="o">=</span> <span class="n">tn</span><span class="o">.</span><span class="n">qualifier</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf - 8&quot;</span><span class="p">)</span>
                <span class="n">name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">nsn</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">t</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">meta</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
                <span class="s2">&quot;durability&quot;</span><span class="p">:</span> <span class="n">TDurability</span><span class="o">.</span><span class="n">_VALUES_TO_NAMES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">durability</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="n">TableDescriptor</span><span class="o">.</span><span class="n">attributes</span><span class="p">:</span>
                <span class="n">meta</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">k</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">):</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">TableDescriptor</span><span class="o">.</span><span class="n">attributes</span><span class="o">.</span><span class="n">items</span><span class="p">()})</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">meta</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="c1"># 表操作</span>
    <span class="k">def</span> <span class="nf">create_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">families</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span> <span class="o">*</span><span class="p">,</span>
                     <span class="n">ns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                     <span class="n">attributes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                     <span class="n">durability</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                     <span class="n">splitKeys</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;创建表.</span>

<span class="sd">        必须要先创建namespace.</span>

<span class="sd">        Args:</span>
<span class="sd">            table (string): 表名,表名中如果是&quot;ns:table&quot;的形式已经指定了命名空间则可以不填ns参数</span>
<span class="sd">            families (List[Dict[str, Any]]): 列簇信息字典</span>
<span class="sd">            ns (Optional[str]): 命名空间名称</span>
<span class="sd">            attributes (Optional[Dict[str, bytes]]): 表属性设置</span>
<span class="sd">            durability  (Optional[str]): 表耐久方式设置,可选的有USE_DEFAULT,SKIP_WAL,ASYNC_WAL,SYNC_WAL,FSYNC_WAL</span>
<span class="sd">            splitKeys (Optional[str]): 表初始区域键过滤设置</span>

<span class="sd">        Raises:</span>
<span class="sd">            AttributeError: 表名格式不合法</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ns</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tableName</span> <span class="o">=</span> <span class="n">TTableName</span><span class="p">(</span><span class="n">qualifier</span><span class="o">=</span><span class="n">table</span><span class="p">,</span> <span class="n">ns</span><span class="o">=</span><span class="n">ns</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tabelinfo</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tabelinfo</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">tableName</span> <span class="o">=</span> <span class="n">TTableName</span><span class="p">(</span><span class="n">qualifier</span><span class="o">=</span><span class="n">table</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">tabelinfo</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">tableName</span> <span class="o">=</span> <span class="n">TTableName</span><span class="p">(</span><span class="n">qualifier</span><span class="o">=</span><span class="n">tabelinfo</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ns</span><span class="o">=</span><span class="n">tabelinfo</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;parameter table syntax error: </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">sk</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">splitKeys</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">splitKeys</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">sk</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">splitKeys</span><span class="p">]</span>
        <span class="n">d</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">durability</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">TDurability</span><span class="o">.</span><span class="n">_NAMES_TO_VALUES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">durability</span><span class="p">)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">attributes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">):</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">attributes</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">createTable</span><span class="p">(</span>
            <span class="n">desc</span><span class="o">=</span><span class="n">TTableDescriptor</span><span class="p">(</span>
                <span class="n">tableName</span><span class="o">=</span><span class="n">tableName</span><span class="p">,</span>
                <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">TColumnFamilyDescriptor</span><span class="p">(</span><span class="o">**</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">families</span><span class="p">],</span>
                <span class="n">attributes</span><span class="o">=</span><span class="n">a</span><span class="p">,</span>
                <span class="n">durability</span><span class="o">=</span><span class="n">d</span><span class="p">),</span>
            <span class="n">splitKeys</span><span class="o">=</span><span class="n">sk</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">table_exists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">ns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;检查表是否存在</span>

<span class="sd">        Args:</span>
<span class="sd">            table (str): 表名,表名中如果是&quot;ns:table&quot;的形式已经指定了命名空间则可以不填ns参数</span>
<span class="sd">            ns (Optional[str], optional): 命名空间名称</span>

<span class="sd">        Raises:</span>
<span class="sd">            AttributeError: 表名格式不合法</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: 是否存在</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ns</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tableName</span> <span class="o">=</span> <span class="n">TTableName</span><span class="p">(</span><span class="n">qualifier</span><span class="o">=</span><span class="n">table</span><span class="p">,</span> <span class="n">ns</span><span class="o">=</span><span class="n">ns</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tabelinfo</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tabelinfo</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">tableName</span> <span class="o">=</span> <span class="n">TTableName</span><span class="p">(</span><span class="n">qualifier</span><span class="o">=</span><span class="n">table</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">tabelinfo</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">tableName</span> <span class="o">=</span> <span class="n">TTableName</span><span class="p">(</span><span class="n">qualifier</span><span class="o">=</span><span class="n">tabelinfo</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ns</span><span class="o">=</span><span class="n">tabelinfo</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;parameter table syntax error: </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">flg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">tableExists</span><span class="p">(</span><span class="n">tableName</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">flg</span>

    <span class="k">def</span> <span class="nf">desc_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">ns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;查看指定表的基本信息.</span>

<span class="sd">        Args:</span>
<span class="sd">            table(str): 表名, 表名中如果是&quot;ns:table&quot;的形式已经指定了命名空间则可以不填ns参数</span>
<span class="sd">            ns(Optional[str], optional): 命名空间名称</span>

<span class="sd">        Raises:</span>
<span class="sd">            AttributeError: 表名格式不合法</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict[str, str]: 描述表基础信息</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ns</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tableName</span> <span class="o">=</span> <span class="n">TTableName</span><span class="p">(</span><span class="n">qualifier</span><span class="o">=</span><span class="n">table</span><span class="p">,</span> <span class="n">ns</span><span class="o">=</span><span class="n">ns</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tabelinfo</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tabelinfo</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">tableName</span> <span class="o">=</span> <span class="n">TTableName</span><span class="p">(</span><span class="n">qualifier</span><span class="o">=</span><span class="n">table</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">tabelinfo</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">tableName</span> <span class="o">=</span> <span class="n">TTableName</span><span class="p">(</span><span class="n">qualifier</span><span class="o">=</span><span class="n">tabelinfo</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ns</span><span class="o">=</span><span class="n">tabelinfo</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;parameter table syntax error: </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">TableDescriptor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">getTableDescriptor</span><span class="p">(</span><span class="n">tableName</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">TableDescriptor</span><span class="o">.</span><span class="n">durability</span><span class="p">:</span>
            <span class="n">durability</span> <span class="o">=</span> <span class="n">TableDescriptor</span><span class="o">.</span><span class="n">durability</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">durability</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">families</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">TableDescriptor</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">family</span> <span class="ow">in</span> <span class="n">TableDescriptor</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="n">families</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">family</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="n">TableDescriptor</span><span class="o">.</span><span class="n">tableName</span><span class="p">:</span>
            <span class="n">tn</span> <span class="o">=</span> <span class="n">TableDescriptor</span><span class="o">.</span><span class="n">tableName</span>
            <span class="n">nsn</span> <span class="o">=</span> <span class="n">tn</span><span class="o">.</span><span class="n">ns</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf - 8&quot;</span><span class="p">)</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">tn</span><span class="o">.</span><span class="n">qualifier</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf - 8&quot;</span><span class="p">)</span>
            <span class="n">name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">nsn</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">t</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="n">meta</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;durability&quot;</span><span class="p">:</span> <span class="n">TDurability</span><span class="o">.</span><span class="n">_VALUES_TO_NAMES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">durability</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
            <span class="s2">&quot;families&quot;</span><span class="p">:</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">families</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">TableDescriptor</span><span class="o">.</span><span class="n">attributes</span><span class="p">:</span>
            <span class="n">meta</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">k</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">):</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">TableDescriptor</span><span class="o">.</span><span class="n">attributes</span><span class="o">.</span><span class="n">items</span><span class="p">()})</span>

        <span class="k">return</span> <span class="n">meta</span>

    <span class="k">def</span> <span class="nf">show_families</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">ns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;查看指定表中包含的列簇信息.</span>

<span class="sd">        Args:</span>
<span class="sd">            table(str): 表名, 表名中如果是&quot;ns:table&quot;的形式已经指定了命名空间则可以不填ns参数</span>
<span class="sd">            ns(Optional[str], optional): 命名空间名称</span>

<span class="sd">        Raises:</span>
<span class="sd">            AttributeError: 表名格式不合法</span>

<span class="sd">        Returns:</span>
<span class="sd">            List[Dict[str, Any]]: 列簇信息</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ns</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tableName</span> <span class="o">=</span> <span class="n">TTableName</span><span class="p">(</span><span class="n">qualifier</span><span class="o">=</span><span class="n">table</span><span class="p">,</span> <span class="n">ns</span><span class="o">=</span><span class="n">ns</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tabelinfo</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tabelinfo</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">tableName</span> <span class="o">=</span> <span class="n">TTableName</span><span class="p">(</span><span class="n">qualifier</span><span class="o">=</span><span class="n">table</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">tabelinfo</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">tableName</span> <span class="o">=</span> <span class="n">TTableName</span><span class="p">(</span><span class="n">qualifier</span><span class="o">=</span><span class="n">tabelinfo</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ns</span><span class="o">=</span><span class="n">tabelinfo</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;parameter table syntax error: </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">TableDescriptor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">getTableDescriptor</span><span class="p">(</span><span class="n">tableName</span><span class="p">)</span>
        <span class="n">families</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">TableDescriptor</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">family</span> <span class="ow">in</span> <span class="n">TableDescriptor</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">family</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
                <span class="p">}</span>
                <span class="k">if</span> <span class="n">family</span><span class="o">.</span><span class="n">attributes</span><span class="p">:</span>
                    <span class="n">temp</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;attributes&quot;</span><span class="p">:</span> <span class="p">{</span><span class="n">k</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">):</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">family</span><span class="o">.</span><span class="n">attributes</span><span class="o">.</span><span class="n">items</span><span class="p">()}})</span>
                <span class="k">if</span> <span class="n">family</span><span class="o">.</span><span class="n">configuration</span><span class="p">:</span>
                    <span class="n">temp</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;configuration&quot;</span><span class="p">:</span> <span class="n">family</span><span class="o">.</span><span class="n">configuration</span><span class="p">})</span>
                <span class="k">if</span> <span class="n">family</span><span class="o">.</span><span class="n">dfsReplication</span><span class="p">:</span>
                    <span class="n">temp</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;dfsReplication&quot;</span><span class="p">:</span> <span class="n">family</span><span class="o">.</span><span class="n">dfsReplication</span><span class="p">})</span>
                <span class="k">if</span> <span class="n">family</span><span class="o">.</span><span class="n">blockSize</span><span class="p">:</span>
                    <span class="n">temp</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;blockSize&quot;</span><span class="p">:</span> <span class="n">family</span><span class="o">.</span><span class="n">blockSize</span><span class="p">})</span>
                <span class="k">if</span> <span class="n">family</span><span class="o">.</span><span class="n">maxVersions</span><span class="p">:</span>
                    <span class="n">temp</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;maxVersions&quot;</span><span class="p">:</span> <span class="n">family</span><span class="o">.</span><span class="n">maxVersions</span><span class="p">})</span>
                <span class="k">if</span> <span class="n">family</span><span class="o">.</span><span class="n">minVersions</span><span class="p">:</span>
                    <span class="n">temp</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;minVersions&quot;</span><span class="p">:</span> <span class="n">family</span><span class="o">.</span><span class="n">minVersions</span><span class="p">})</span>
                <span class="k">if</span> <span class="n">family</span><span class="o">.</span><span class="n">scope</span><span class="p">:</span>
                    <span class="n">temp</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;scope&quot;</span><span class="p">:</span> <span class="n">family</span><span class="o">.</span><span class="n">scope</span><span class="p">})</span>
                <span class="k">if</span> <span class="n">family</span><span class="o">.</span><span class="n">timeToLive</span><span class="p">:</span>
                    <span class="n">temp</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;timeToLive&quot;</span><span class="p">:</span> <span class="n">family</span><span class="o">.</span><span class="n">timeToLive</span><span class="p">})</span>
                <span class="k">if</span> <span class="n">family</span><span class="o">.</span><span class="n">blockCacheEnabled</span><span class="p">:</span>
                    <span class="n">temp</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;blockCacheEnabled&quot;</span><span class="p">:</span> <span class="n">family</span><span class="o">.</span><span class="n">blockCacheEnabled</span><span class="p">})</span>
                <span class="k">if</span> <span class="n">family</span><span class="o">.</span><span class="n">cacheBloomsOnWrite</span><span class="p">:</span>
                    <span class="n">temp</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;cacheBloomsOnWrite&quot;</span><span class="p">:</span> <span class="n">family</span><span class="o">.</span><span class="n">cacheBloomsOnWrite</span><span class="p">})</span>
                <span class="k">if</span> <span class="n">family</span><span class="o">.</span><span class="n">cacheDataOnWrite</span><span class="p">:</span>
                    <span class="n">temp</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;cacheDataOnWrite&quot;</span><span class="p">:</span> <span class="n">family</span><span class="o">.</span><span class="n">cacheDataOnWrite</span><span class="p">})</span>
                <span class="k">if</span> <span class="n">family</span><span class="o">.</span><span class="n">cacheIndexesOnWrite</span><span class="p">:</span>
                    <span class="n">temp</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;cacheIndexesOnWrite&quot;</span><span class="p">:</span> <span class="n">family</span><span class="o">.</span><span class="n">cacheIndexesOnWrite</span><span class="p">})</span>
                <span class="k">if</span> <span class="n">family</span><span class="o">.</span><span class="n">compressTags</span><span class="p">:</span>
                    <span class="n">temp</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;compressTags&quot;</span><span class="p">:</span> <span class="n">family</span><span class="o">.</span><span class="n">compressTags</span><span class="p">})</span>
                <span class="k">if</span> <span class="n">family</span><span class="o">.</span><span class="n">evictBlocksOnClose</span><span class="p">:</span>
                    <span class="n">temp</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;evictBlocksOnClose&quot;</span><span class="p">:</span> <span class="n">family</span><span class="o">.</span><span class="n">evictBlocksOnClose</span><span class="p">})</span>
                <span class="k">if</span> <span class="n">family</span><span class="o">.</span><span class="n">inMemory</span><span class="p">:</span>
                    <span class="n">temp</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;inMemory&quot;</span><span class="p">:</span> <span class="n">family</span><span class="o">.</span><span class="n">inMemory</span><span class="p">})</span>

                <span class="n">bloomnFilterType</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">if</span> <span class="n">family</span><span class="o">.</span><span class="n">bloomnFilterType</span><span class="p">:</span>
                    <span class="n">bloomnFilterType</span> <span class="o">=</span> <span class="n">family</span><span class="o">.</span><span class="n">bloomnFilterType</span>
                    <span class="n">temp</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;bloomnFilterType&quot;</span><span class="p">:</span> <span class="n">TBloomFilterType</span><span class="o">.</span><span class="n">_VALUES_TO_NAMES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">bloomnFilterType</span><span class="p">)})</span>

                <span class="n">compressionType</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">if</span> <span class="n">family</span><span class="o">.</span><span class="n">compressionType</span><span class="p">:</span>
                    <span class="n">compressionType</span> <span class="o">=</span> <span class="n">family</span><span class="o">.</span><span class="n">compressionType</span>
                    <span class="n">temp</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;compressionType&quot;</span><span class="p">:</span> <span class="n">TCompressionAlgorithm</span><span class="o">.</span><span class="n">_VALUES_TO_NAMES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">compressionType</span><span class="p">)})</span>

                <span class="n">dataBlockEncoding</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">if</span> <span class="n">family</span><span class="o">.</span><span class="n">dataBlockEncoding</span><span class="p">:</span>
                    <span class="n">dataBlockEncoding</span> <span class="o">=</span> <span class="n">family</span><span class="o">.</span><span class="n">dataBlockEncoding</span>
                    <span class="n">temp</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;dataBlockEncoding&quot;</span><span class="p">:</span> <span class="n">TDataBlockEncoding</span><span class="o">.</span><span class="n">_VALUES_TO_NAMES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">dataBlockEncoding</span><span class="p">)})</span>

                <span class="n">keepDeletedCells</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">if</span> <span class="n">family</span><span class="o">.</span><span class="n">keepDeletedCells</span><span class="p">:</span>
                    <span class="n">keepDeletedCells</span> <span class="o">=</span> <span class="n">family</span><span class="o">.</span><span class="n">keepDeletedCells</span>
                    <span class="n">temp</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;keepDeletedCells&quot;</span><span class="p">:</span> <span class="n">TKeepDeletedCells</span><span class="o">.</span><span class="n">_VALUES_TO_NAMES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">keepDeletedCells</span><span class="p">)})</span>

                <span class="n">families</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">families</span>

    <span class="k">def</span> <span class="nf">delete_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">ns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;删除表.</span>

<span class="sd">        Args:</span>
<span class="sd">            table(str): 表名, 表名中如果是&quot;ns:table&quot;的形式已经指定了命名空间则可以不填ns参数</span>
<span class="sd">            ns(Optional[str], optional): 命名空间名称</span>

<span class="sd">        Raises:</span>
<span class="sd">            AttributeError: 表名格式不合法</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ns</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tableName</span> <span class="o">=</span> <span class="n">TTableName</span><span class="p">(</span><span class="n">qualifier</span><span class="o">=</span><span class="n">table</span><span class="p">,</span> <span class="n">ns</span><span class="o">=</span><span class="n">ns</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tabelinfo</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tabelinfo</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">tableName</span> <span class="o">=</span> <span class="n">TTableName</span><span class="p">(</span><span class="n">qualifier</span><span class="o">=</span><span class="n">table</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">tabelinfo</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">tableName</span> <span class="o">=</span> <span class="n">TTableName</span><span class="p">(</span><span class="n">qualifier</span><span class="o">=</span><span class="n">tabelinfo</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ns</span><span class="o">=</span><span class="n">tabelinfo</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;parameter table syntax error: </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">deleteTable</span><span class="p">(</span><span class="n">tableName</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">truncate_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">ns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">preserveSplits</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;清空表.</span>

<span class="sd">        Args:</span>
<span class="sd">            table(str): 表名, 表名中如果是&quot;ns:table&quot;的形式已经指定了命名空间则可以不填ns参数</span>
<span class="sd">            ns(Optional[str], optional): 命名空间名称</span>
<span class="sd">            preserveSplits (bool): 是否保留以前的拆分,默认False</span>
<span class="sd">        Raises:</span>
<span class="sd">            AttributeError: 表名格式不合法</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ns</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tableName</span> <span class="o">=</span> <span class="n">TTableName</span><span class="p">(</span><span class="n">qualifier</span><span class="o">=</span><span class="n">table</span><span class="p">,</span> <span class="n">ns</span><span class="o">=</span><span class="n">ns</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tabelinfo</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tabelinfo</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">tableName</span> <span class="o">=</span> <span class="n">TTableName</span><span class="p">(</span><span class="n">qualifier</span><span class="o">=</span><span class="n">table</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">tabelinfo</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">tableName</span> <span class="o">=</span> <span class="n">TTableName</span><span class="p">(</span><span class="n">qualifier</span><span class="o">=</span><span class="n">tabelinfo</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ns</span><span class="o">=</span><span class="n">tabelinfo</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;parameter table syntax error: </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">truncateTable</span><span class="p">(</span><span class="n">tableName</span><span class="p">,</span> <span class="n">preserveSplits</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">enable_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">ns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;激活表.</span>

<span class="sd">        Args:</span>
<span class="sd">            table(str): 表名, 表名中如果是&quot;ns:table&quot;的形式已经指定了命名空间则可以不填ns参数</span>
<span class="sd">            ns(Optional[str], optional): 命名空间名称</span>
<span class="sd">        Raises:</span>
<span class="sd">            AttributeError: 表名格式不合法</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ns</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tableName</span> <span class="o">=</span> <span class="n">TTableName</span><span class="p">(</span><span class="n">qualifier</span><span class="o">=</span><span class="n">table</span><span class="p">,</span> <span class="n">ns</span><span class="o">=</span><span class="n">ns</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tabelinfo</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tabelinfo</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">tableName</span> <span class="o">=</span> <span class="n">TTableName</span><span class="p">(</span><span class="n">qualifier</span><span class="o">=</span><span class="n">table</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">tabelinfo</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">tableName</span> <span class="o">=</span> <span class="n">TTableName</span><span class="p">(</span><span class="n">qualifier</span><span class="o">=</span><span class="n">tabelinfo</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ns</span><span class="o">=</span><span class="n">tabelinfo</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;parameter table syntax error: </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">enableTable</span><span class="p">(</span><span class="n">tableName</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">disable_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">ns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;取消激活表.</span>

<span class="sd">        Args:</span>
<span class="sd">            table(str): 表名, 表名中如果是&quot;ns:table&quot;的形式已经指定了命名空间则可以不填ns参数</span>
<span class="sd">            ns(Optional[str], optional): 命名空间名称</span>
<span class="sd">        Raises:</span>
<span class="sd">            AttributeError: 表名格式不合法</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ns</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tableName</span> <span class="o">=</span> <span class="n">TTableName</span><span class="p">(</span><span class="n">qualifier</span><span class="o">=</span><span class="n">table</span><span class="p">,</span> <span class="n">ns</span><span class="o">=</span><span class="n">ns</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tabelinfo</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tabelinfo</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">tableName</span> <span class="o">=</span> <span class="n">TTableName</span><span class="p">(</span><span class="n">qualifier</span><span class="o">=</span><span class="n">table</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">tabelinfo</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">tableName</span> <span class="o">=</span> <span class="n">TTableName</span><span class="p">(</span><span class="n">qualifier</span><span class="o">=</span><span class="n">tabelinfo</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ns</span><span class="o">=</span><span class="n">tabelinfo</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;parameter table syntax error: </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">disableTable</span><span class="p">(</span><span class="n">tableName</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">is_table_enabled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">ns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;确认表是否已经激活.</span>

<span class="sd">        Args:</span>
<span class="sd">            table(str): 表名, 表名中如果是&quot;ns:table&quot;的形式已经指定了命名空间则可以不填ns参数</span>
<span class="sd">            ns(Optional[str], optional): 命名空间名称</span>
<span class="sd">        Raises:</span>
<span class="sd">            AttributeError: 表名格式不合法</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: 是否已激活</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ns</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tableName</span> <span class="o">=</span> <span class="n">TTableName</span><span class="p">(</span><span class="n">qualifier</span><span class="o">=</span><span class="n">table</span><span class="p">,</span> <span class="n">ns</span><span class="o">=</span><span class="n">ns</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tabelinfo</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tabelinfo</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">tableName</span> <span class="o">=</span> <span class="n">TTableName</span><span class="p">(</span><span class="n">qualifier</span><span class="o">=</span><span class="n">table</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">tabelinfo</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">tableName</span> <span class="o">=</span> <span class="n">TTableName</span><span class="p">(</span><span class="n">qualifier</span><span class="o">=</span><span class="n">tabelinfo</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ns</span><span class="o">=</span><span class="n">tabelinfo</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;parameter table syntax error: </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">isTableEnabled</span><span class="p">(</span><span class="n">tableName</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">is_table_disabled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">ns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;确认表是否已经取消激活.</span>

<span class="sd">        Args:</span>
<span class="sd">            table(str): 表名, 表名中如果是&quot;ns:table&quot;的形式已经指定了命名空间则可以不填ns参数</span>
<span class="sd">            ns(Optional[str], optional): 命名空间名称</span>
<span class="sd">        Raises:</span>
<span class="sd">            AttributeError: 表名格式不合法</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: 是否已取消激活</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ns</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tableName</span> <span class="o">=</span> <span class="n">TTableName</span><span class="p">(</span><span class="n">qualifier</span><span class="o">=</span><span class="n">table</span><span class="p">,</span> <span class="n">ns</span><span class="o">=</span><span class="n">ns</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tabelinfo</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tabelinfo</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">tableName</span> <span class="o">=</span> <span class="n">TTableName</span><span class="p">(</span><span class="n">qualifier</span><span class="o">=</span><span class="n">table</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">tabelinfo</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">tableName</span> <span class="o">=</span> <span class="n">TTableName</span><span class="p">(</span><span class="n">qualifier</span><span class="o">=</span><span class="n">tabelinfo</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ns</span><span class="o">=</span><span class="n">tabelinfo</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;parameter table syntax error: </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">isTableDisabled</span><span class="p">(</span><span class="n">tableName</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">is_table_available</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">ns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;确认表是否可用.</span>

<span class="sd">        Args:</span>
<span class="sd">            table(str): 表名, 表名中如果是&quot;ns:table&quot;的形式已经指定了命名空间则可以不填ns参数</span>
<span class="sd">            ns(Optional[str], optional): 命名空间名称</span>
<span class="sd">        Raises:</span>
<span class="sd">            AttributeError: 表名格式不合法</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: 是否可用</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ns</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tableName</span> <span class="o">=</span> <span class="n">TTableName</span><span class="p">(</span><span class="n">qualifier</span><span class="o">=</span><span class="n">table</span><span class="p">,</span> <span class="n">ns</span><span class="o">=</span><span class="n">ns</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tabelinfo</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tabelinfo</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">tableName</span> <span class="o">=</span> <span class="n">TTableName</span><span class="p">(</span><span class="n">qualifier</span><span class="o">=</span><span class="n">table</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">tabelinfo</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">tableName</span> <span class="o">=</span> <span class="n">TTableName</span><span class="p">(</span><span class="n">qualifier</span><span class="o">=</span><span class="n">tabelinfo</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ns</span><span class="o">=</span><span class="n">tabelinfo</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;parameter table syntax error: </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">isTableAvailable</span><span class="p">(</span><span class="n">tableName</span><span class="p">)</span>

    <span class="c1"># 列簇操作</span>
    <span class="k">def</span> <span class="nf">create_family</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">family</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                      <span class="n">ns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="n">attributes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="n">configuration</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="n">blockSize</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="n">bloomnFilterType</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="n">compressionType</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="n">dfsReplication</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="n">dataBlockEncoding</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="n">keepDeletedCells</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="n">maxVersions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="n">minVersions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="n">scope</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="n">timeToLive</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="n">blockCacheEnabled</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="n">cacheBloomsOnWrite</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="n">cacheDataOnWrite</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="n">cacheIndexesOnWrite</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="n">compressTags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="n">evictBlocksOnClose</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="n">inMemory</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;创建列簇.</span>

<span class="sd">        Args:</span>
<span class="sd">            table (str):  表名, 表名中如果是&quot;ns:table&quot;的形式已经指定了命名空间则可以不填ns参数</span>
<span class="sd">            family (str): 列簇名</span>
<span class="sd">            ns(Optional[str], optional): 命名空间名称</span>
<span class="sd">            attributes (Optional[Dict[str, bytes]], optional): 列簇属性设置. Defaults to None.</span>
<span class="sd">            configuration (Optional[Dict[str, str]], optional): 列簇设置项. Defaults to None.</span>
<span class="sd">            blockSize (Optional[int], optional): 块大小设置. Defaults to None.</span>
<span class="sd">            bloomnFilterType (str, optional): 布隆过滤器类型.可选NONE,ROW,ROWCOL,ROWPREFIX_FIXED_LENGTH</span>
<span class="sd">            compressionType (str, optional): 存储压缩类型.可选LZO,GZ,NONE,SNAPPY,LZ4,BZIP2,ZSTD</span>
<span class="sd">            dfsReplication (Optional[int], optional): dfs复制类型. Defaults to None.</span>
<span class="sd">            dataBlockEncoding (str, optional): 数据块编码类型. 可选NONE,PREFIX,DIFF,FAST_DIFF,ROW_INDEX_V1</span>
<span class="sd">            keepDeletedCells (str, optional): 删除cell策略类型. 可选FALSE,TRUE,TTL</span>
<span class="sd">            maxVersions (Optional[int], optional): 数据最大版本. Defaults to None.</span>
<span class="sd">            minVersions (Optional[int], optional): 数据最小版本. Defaults to None.</span>
<span class="sd">            scope (Optional[int], optional): 范围. Defaults to None.</span>
<span class="sd">            timeToLive (Optional[int], optional): 数据过期时间. Defaults to None.</span>
<span class="sd">            blockCacheEnabled (bool, optional): 是否开启块缓存. Defaults to False.</span>
<span class="sd">            cacheBloomsOnWrite (bool, optional): 是否在写入时缓存布隆过滤器的结果. Defaults to False.</span>
<span class="sd">            cacheDataOnWrite (bool, optional): 是否在写入数据时缓存数据. Defaults to False.</span>
<span class="sd">            cacheIndexesOnWrite (bool, optional): 是否在写入数据时缓存index. Defaults to False.</span>
<span class="sd">            compressTags (bool, optional): 是否压缩tag. Defaults to False.</span>
<span class="sd">            evictBlocksOnClose (bool, optional): 是否关闭时驱逐块. Defaults to False.</span>
<span class="sd">            inMemory (bool, optional): 是否保存在内存中. Defaults to False.</span>

<span class="sd">        Raises:</span>
<span class="sd">            AttributeError: 表名格式不合法</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ns</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tableName</span> <span class="o">=</span> <span class="n">TTableName</span><span class="p">(</span><span class="n">qualifier</span><span class="o">=</span><span class="n">table</span><span class="p">,</span> <span class="n">ns</span><span class="o">=</span><span class="n">ns</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tabelinfo</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tabelinfo</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">tableName</span> <span class="o">=</span> <span class="n">TTableName</span><span class="p">(</span><span class="n">qualifier</span><span class="o">=</span><span class="n">table</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">tabelinfo</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">tableName</span> <span class="o">=</span> <span class="n">TTableName</span><span class="p">(</span><span class="n">qualifier</span><span class="o">=</span><span class="n">tabelinfo</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ns</span><span class="o">=</span><span class="n">tabelinfo</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;parameter table syntax error: </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">_bloomnFilterType</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">bloomnFilterType</span><span class="p">:</span>
            <span class="n">_bloomnFilterType</span> <span class="o">=</span> <span class="n">TBloomFilterType</span><span class="o">.</span><span class="n">_NAMES_TO_VALUES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">bloomnFilterType</span><span class="p">)</span>

        <span class="n">_compressionType</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">compressionType</span><span class="p">:</span>
            <span class="n">_compressionType</span> <span class="o">=</span> <span class="n">TCompressionAlgorithm</span><span class="o">.</span><span class="n">_NAMES_TO_VALUES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">compressionType</span><span class="p">)</span>
        <span class="n">_dataBlockEncoding</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">dataBlockEncoding</span><span class="p">:</span>
            <span class="n">_dataBlockEncoding</span> <span class="o">=</span> <span class="n">TDataBlockEncoding</span><span class="o">.</span><span class="n">_NAMES_TO_VALUES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">dataBlockEncoding</span><span class="p">)</span>

        <span class="n">_keepDeletedCells</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">keepDeletedCells</span><span class="p">:</span>
            <span class="n">_keepDeletedCells</span> <span class="o">=</span> <span class="n">TKeepDeletedCells</span><span class="o">.</span><span class="n">_NAMES_TO_VALUES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">keepDeletedCells</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">addColumnFamily</span><span class="p">(</span>
            <span class="n">tableName</span><span class="p">,</span>
            <span class="n">TColumnFamilyDescriptor</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="n">family</span><span class="p">,</span>
                <span class="n">attributes</span><span class="o">=</span><span class="n">attributes</span><span class="p">,</span>
                <span class="n">configuration</span><span class="o">=</span><span class="n">configuration</span><span class="p">,</span>
                <span class="n">blockSize</span><span class="o">=</span><span class="n">blockSize</span><span class="p">,</span>
                <span class="n">bloomnFilterType</span><span class="o">=</span><span class="n">_bloomnFilterType</span><span class="p">,</span>
                <span class="n">compressionType</span><span class="o">=</span><span class="n">_compressionType</span><span class="p">,</span>
                <span class="n">dfsReplication</span><span class="o">=</span><span class="n">dfsReplication</span><span class="p">,</span>
                <span class="n">dataBlockEncoding</span><span class="o">=</span><span class="n">_dataBlockEncoding</span><span class="p">,</span>
                <span class="n">keepDeletedCells</span><span class="o">=</span><span class="n">_keepDeletedCells</span><span class="p">,</span>
                <span class="n">maxVersions</span><span class="o">=</span><span class="n">maxVersions</span><span class="p">,</span>
                <span class="n">minVersions</span><span class="o">=</span><span class="n">minVersions</span><span class="p">,</span>
                <span class="n">scope</span><span class="o">=</span><span class="n">scope</span><span class="p">,</span>
                <span class="n">timeToLive</span><span class="o">=</span><span class="n">timeToLive</span><span class="p">,</span>
                <span class="n">blockCacheEnabled</span><span class="o">=</span><span class="n">blockCacheEnabled</span><span class="p">,</span>
                <span class="n">cacheBloomsOnWrite</span><span class="o">=</span><span class="n">cacheBloomsOnWrite</span><span class="p">,</span>
                <span class="n">cacheDataOnWrite</span><span class="o">=</span><span class="n">cacheDataOnWrite</span><span class="p">,</span>
                <span class="n">cacheIndexesOnWrite</span><span class="o">=</span><span class="n">cacheIndexesOnWrite</span><span class="p">,</span>
                <span class="n">compressTags</span><span class="o">=</span><span class="n">compressTags</span><span class="p">,</span>
                <span class="n">evictBlocksOnClose</span><span class="o">=</span><span class="n">evictBlocksOnClose</span><span class="p">,</span>
                <span class="n">inMemory</span><span class="o">=</span><span class="n">inMemory</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">delete_family</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">family</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">ns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;删除指定列簇.</span>

<span class="sd">        Args:</span>
<span class="sd">            table (str):  表名, 表名中如果是&quot;ns:table&quot;的形式已经指定了命名空间则可以不填ns参数</span>
<span class="sd">            family (str): 列簇名</span>
<span class="sd">            ns(Optional[str], optional): 命名空间名称</span>

<span class="sd">        Raises:</span>
<span class="sd">            AttributeError: _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ns</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tableName</span> <span class="o">=</span> <span class="n">TTableName</span><span class="p">(</span><span class="n">qualifier</span><span class="o">=</span><span class="n">table</span><span class="p">,</span> <span class="n">ns</span><span class="o">=</span><span class="n">ns</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tabelinfo</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tabelinfo</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">tableName</span> <span class="o">=</span> <span class="n">TTableName</span><span class="p">(</span><span class="n">qualifier</span><span class="o">=</span><span class="n">table</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">tabelinfo</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">tableName</span> <span class="o">=</span> <span class="n">TTableName</span><span class="p">(</span><span class="n">qualifier</span><span class="o">=</span><span class="n">tabelinfo</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ns</span><span class="o">=</span><span class="n">tabelinfo</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;parameter table syntax error: </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">deleteColumnFamily</span><span class="p">(</span><span class="n">tableName</span><span class="p">,</span> <span class="n">family</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">modify_family</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">family</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                      <span class="n">ns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="n">attributes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="n">configuration</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="n">blockSize</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="n">bloomnFilterType</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="n">compressionType</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="n">dfsReplication</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="n">dataBlockEncoding</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="n">keepDeletedCells</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="n">maxVersions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="n">minVersions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="n">scope</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="n">timeToLive</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="n">blockCacheEnabled</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="n">cacheBloomsOnWrite</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="n">cacheDataOnWrite</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="n">cacheIndexesOnWrite</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="n">compressTags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="n">evictBlocksOnClose</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="n">inMemory</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;修改已存在列簇.</span>

<span class="sd">        不和创建列簇合并是因为担心会有误操作.</span>

<span class="sd">        Args:</span>
<span class="sd">            table (str):  表名, 表名中如果是&quot;ns:table&quot;的形式已经指定了命名空间则可以不填ns参数</span>
<span class="sd">            family (str): 列簇名</span>
<span class="sd">            ns(Optional[str], optional): 命名空间名称</span>
<span class="sd">            attributes (Optional[Dict[str, bytes]], optional): 列簇属性设置. Defaults to None.</span>
<span class="sd">            configuration (Optional[Dict[str, str]], optional): 列簇设置项. Defaults to None.</span>
<span class="sd">            blockSize (Optional[int], optional): 块大小设置. Defaults to None.</span>
<span class="sd">            bloomnFilterType (str, optional): 布隆过滤器类型.可选NONE,ROW,ROWCOL,ROWPREFIX_FIXED_LENGTH</span>
<span class="sd">            compressionType (str, optional): 存储压缩类型.可选LZO,GZ,NONE,SNAPPY,LZ4,BZIP2,ZSTD</span>
<span class="sd">            dfsReplication (Optional[int], optional): dfs复制类型. Defaults to None.</span>
<span class="sd">            dataBlockEncoding (str, optional): 数据块编码类型. 可选NONE,PREFIX,DIFF,FAST_DIFF,ROW_INDEX_V1</span>
<span class="sd">            keepDeletedCells (str, optional): 删除cell策略类型. 可选FALSE,TRUE,TTL</span>
<span class="sd">            maxVersions (Optional[int], optional): 数据最大版本. Defaults to None.</span>
<span class="sd">            minVersions (Optional[int], optional): 数据最小版本. Defaults to None.</span>
<span class="sd">            scope (Optional[int], optional): 范围. Defaults to None.</span>
<span class="sd">            timeToLive (Optional[int], optional): 数据过期时间. Defaults to None.</span>
<span class="sd">            blockCacheEnabled (bool, optional): 是否开启块缓存. Defaults to False.</span>
<span class="sd">            cacheBloomsOnWrite (bool, optional): 是否在写入时缓存布隆过滤器的结果. Defaults to False.</span>
<span class="sd">            cacheDataOnWrite (bool, optional): 是否在写入数据时缓存数据. Defaults to False.</span>
<span class="sd">            cacheIndexesOnWrite (bool, optional): 是否在写入数据时缓存index. Defaults to False.</span>
<span class="sd">            compressTags (bool, optional): 是否压缩tag. Defaults to False.</span>
<span class="sd">            evictBlocksOnClose (bool, optional): 是否关闭时驱逐块. Defaults to False.</span>
<span class="sd">            inMemory (bool, optional): 是否保存在内存中. Defaults to False.</span>

<span class="sd">        Raises:</span>
<span class="sd">            AttributeError: 表名格式不合法</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ns</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tableName</span> <span class="o">=</span> <span class="n">TTableName</span><span class="p">(</span><span class="n">qualifier</span><span class="o">=</span><span class="n">table</span><span class="p">,</span> <span class="n">ns</span><span class="o">=</span><span class="n">ns</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tabelinfo</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tabelinfo</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">tableName</span> <span class="o">=</span> <span class="n">TTableName</span><span class="p">(</span><span class="n">qualifier</span><span class="o">=</span><span class="n">table</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">tabelinfo</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">tableName</span> <span class="o">=</span> <span class="n">TTableName</span><span class="p">(</span><span class="n">qualifier</span><span class="o">=</span><span class="n">tabelinfo</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ns</span><span class="o">=</span><span class="n">tabelinfo</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;parameter table syntax error: </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">_bloomnFilterType</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">bloomnFilterType</span><span class="p">:</span>
            <span class="n">_bloomnFilterType</span> <span class="o">=</span> <span class="n">TBloomFilterType</span><span class="o">.</span><span class="n">_NAMES_TO_VALUES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">bloomnFilterType</span><span class="p">)</span>

        <span class="n">_compressionType</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">compressionType</span><span class="p">:</span>
            <span class="n">_compressionType</span> <span class="o">=</span> <span class="n">TCompressionAlgorithm</span><span class="o">.</span><span class="n">_NAMES_TO_VALUES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">compressionType</span><span class="p">)</span>
        <span class="n">_dataBlockEncoding</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">dataBlockEncoding</span><span class="p">:</span>
            <span class="n">_dataBlockEncoding</span> <span class="o">=</span> <span class="n">TDataBlockEncoding</span><span class="o">.</span><span class="n">_NAMES_TO_VALUES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">dataBlockEncoding</span><span class="p">)</span>

        <span class="n">_keepDeletedCells</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">keepDeletedCells</span><span class="p">:</span>
            <span class="n">_keepDeletedCells</span> <span class="o">=</span> <span class="n">TKeepDeletedCells</span><span class="o">.</span><span class="n">_NAMES_TO_VALUES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">keepDeletedCells</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">modifyColumnFamily</span><span class="p">(</span>
            <span class="n">tableName</span><span class="p">,</span>
            <span class="n">TColumnFamilyDescriptor</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="n">family</span><span class="p">,</span>
                <span class="n">attributes</span><span class="o">=</span><span class="n">attributes</span><span class="p">,</span>
                <span class="n">configuration</span><span class="o">=</span><span class="n">configuration</span><span class="p">,</span>
                <span class="n">blockSize</span><span class="o">=</span><span class="n">blockSize</span><span class="p">,</span>
                <span class="n">bloomnFilterType</span><span class="o">=</span><span class="n">_bloomnFilterType</span><span class="p">,</span>
                <span class="n">compressionType</span><span class="o">=</span><span class="n">_compressionType</span><span class="p">,</span>
                <span class="n">dfsReplication</span><span class="o">=</span><span class="n">dfsReplication</span><span class="p">,</span>
                <span class="n">dataBlockEncoding</span><span class="o">=</span><span class="n">_dataBlockEncoding</span><span class="p">,</span>
                <span class="n">keepDeletedCells</span><span class="o">=</span><span class="n">_keepDeletedCells</span><span class="p">,</span>
                <span class="n">maxVersions</span><span class="o">=</span><span class="n">maxVersions</span><span class="p">,</span>
                <span class="n">minVersions</span><span class="o">=</span><span class="n">minVersions</span><span class="p">,</span>
                <span class="n">scope</span><span class="o">=</span><span class="n">scope</span><span class="p">,</span>
                <span class="n">timeToLive</span><span class="o">=</span><span class="n">timeToLive</span><span class="p">,</span>
                <span class="n">blockCacheEnabled</span><span class="o">=</span><span class="n">blockCacheEnabled</span><span class="p">,</span>
                <span class="n">cacheBloomsOnWrite</span><span class="o">=</span><span class="n">cacheBloomsOnWrite</span><span class="p">,</span>
                <span class="n">cacheDataOnWrite</span><span class="o">=</span><span class="n">cacheDataOnWrite</span><span class="p">,</span>
                <span class="n">cacheIndexesOnWrite</span><span class="o">=</span><span class="n">cacheIndexesOnWrite</span><span class="p">,</span>
                <span class="n">compressTags</span><span class="o">=</span><span class="n">compressTags</span><span class="p">,</span>
                <span class="n">evictBlocksOnClose</span><span class="o">=</span><span class="n">evictBlocksOnClose</span><span class="p">,</span>
                <span class="n">inMemory</span><span class="o">=</span><span class="n">inMemory</span><span class="p">))</span>

    <span class="c1"># 写操作</span>
    <span class="k">def</span> <span class="nf">put</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">row</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">kvs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">ColumnsValue</span><span class="p">],</span> <span class="o">*</span><span class="p">,</span>
            <span class="n">ns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">attributes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">durability</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">cellVisibility</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">check_row</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">check_column_full_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">check_column_value</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;插入一行数据.</span>

<span class="sd">        如果有设置check_row和check_column_full_name则执行checkAndPut方法,即只有当检查通过时才插入</span>

<span class="sd">        Args:</span>
<span class="sd">            table(str): 表名, 表名中如果是&quot;ns:table&quot;的形式已经指定了命名空间则可以不填ns参数</span>
<span class="sd">            row (str): 行名</span>
<span class="sd">            kvs (List[ColumnsValue]): 传入的值序列</span>
<span class="sd">            ns(Optional[str], optional): 命名空间名称</span>
<span class="sd">            timestamp (Optional[datetime.datetime], optional): 指定时间戳. Defaults to None.</span>
<span class="sd">            attributes (Optional[Dict[str, bytes]], optional): 指定属性. Defaults to None.</span>
<span class="sd">            durability (Optional[str], optional): 指定耐久方式设置,可选的有USE_DEFAULT,SKIP_WAL,ASYNC_WAL,SYNC_WAL,FSYNC_WAL.Defaults to None.</span>
<span class="sd">            cellVisibility (Optional[str], optional): cell的可视性设置. Defaults to None.</span>
<span class="sd">            check_row (Optional[str], optional): 待监测行名</span>
<span class="sd">            check_column_full_name (Optional[str], optional): 待检查的列,以`列簇:列名`形式表示,如果有指定`column_value`则检查指定列的值是否和`column_value`指定的相同,否则检查指定列是否存在.</span>
<span class="sd">            check_column_value (Optional[bytes], optional): 指定检查列应该满足的值.</span>

<span class="sd">        Raises:</span>
<span class="sd">            AttributeError: 表名格式不合法</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ns</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tableNameInbytes</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ns</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tabelinfo</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tabelinfo</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">tableNameInbytes</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;parameter table syntax error: </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">row_bytes</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span>
        <span class="n">_timestamp</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">timestamp</span><span class="p">:</span>
            <span class="n">_timestamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">timestamp</span><span class="o">.</span><span class="n">timestamp</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>
        <span class="n">_attributes</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">attributes</span><span class="p">:</span>
            <span class="n">_attributes</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">):</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">attributes</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
        <span class="n">_durability</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">durability</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_durability</span> <span class="o">=</span> <span class="n">TDurability</span><span class="o">.</span><span class="n">_NAMES_TO_VALUES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">durability</span><span class="p">)</span>
        <span class="n">_cellVisibility</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">cellVisibility</span><span class="p">:</span>
            <span class="n">_cellVisibility</span> <span class="o">=</span> <span class="n">TCellVisibility</span><span class="p">(</span><span class="n">expression</span><span class="o">=</span><span class="n">cellVisibility</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">check_row</span> <span class="ow">and</span> <span class="n">check_column_full_name</span><span class="p">:</span>
            <span class="n">check_row_bytes</span> <span class="o">=</span> <span class="n">check_row</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span>
            <span class="n">family</span><span class="p">,</span> <span class="n">cloumn</span> <span class="o">=</span> <span class="n">check_column_full_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">checkAndPut</span><span class="p">(</span>
                <span class="n">table</span><span class="o">=</span><span class="n">tableNameInbytes</span><span class="p">,</span>
                <span class="n">row</span><span class="o">=</span><span class="n">check_row_bytes</span><span class="p">,</span>
                <span class="n">family</span><span class="o">=</span><span class="n">family</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">),</span>
                <span class="n">qualifier</span><span class="o">=</span><span class="n">cloumn</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">),</span>
                <span class="n">value</span><span class="o">=</span><span class="n">check_column_value</span><span class="p">,</span>
                <span class="n">tput</span><span class="o">=</span><span class="n">TPut</span><span class="p">(</span>
                    <span class="n">row</span><span class="o">=</span><span class="n">row_bytes</span><span class="p">,</span>
                    <span class="n">columnValues</span><span class="o">=</span><span class="p">[</span><span class="n">kv</span><span class="o">.</span><span class="n">as_TColumnValue</span><span class="p">()</span> <span class="k">for</span> <span class="n">kv</span> <span class="ow">in</span> <span class="n">kvs</span><span class="p">],</span>
                    <span class="n">timestamp</span><span class="o">=</span><span class="n">_timestamp</span><span class="p">,</span>
                    <span class="n">attributes</span><span class="o">=</span><span class="n">_attributes</span><span class="p">,</span>
                    <span class="n">durability</span><span class="o">=</span><span class="n">_durability</span><span class="p">,</span>
                    <span class="n">cellVisibility</span><span class="o">=</span><span class="n">_cellVisibility</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">put</span><span class="p">(</span>
                <span class="n">table</span><span class="o">=</span><span class="n">tableNameInbytes</span><span class="p">,</span>
                <span class="n">tput</span><span class="o">=</span><span class="n">TPut</span><span class="p">(</span>
                    <span class="n">row</span><span class="o">=</span><span class="n">row_bytes</span><span class="p">,</span>
                    <span class="n">columnValues</span><span class="o">=</span><span class="p">[</span><span class="n">kv</span><span class="o">.</span><span class="n">as_TColumnValue</span><span class="p">()</span> <span class="k">for</span> <span class="n">kv</span> <span class="ow">in</span> <span class="n">kvs</span><span class="p">],</span>
                    <span class="n">timestamp</span><span class="o">=</span><span class="n">_timestamp</span><span class="p">,</span>
                    <span class="n">attributes</span><span class="o">=</span><span class="n">_attributes</span><span class="p">,</span>
                    <span class="n">durability</span><span class="o">=</span><span class="n">_durability</span><span class="p">,</span>
                    <span class="n">cellVisibility</span><span class="o">=</span><span class="n">_cellVisibility</span><span class="p">))</span>
            <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">row</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
               <span class="n">ns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">deleteType</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">attributes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">durability</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">check_row</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">check_column_full_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">check_column_value</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;删除指定行的数据.</span>

<span class="sd">        如果有设置check_row和check_column_full_name则执行checkAndDelete方法,即只有当检查通过时才删除.</span>

<span class="sd">        Args:</span>
<span class="sd">            table (str): 表名, 表名中如果是&quot;ns:table&quot;的形式已经指定了命名空间则可以不填ns参数</span>
<span class="sd">            row (str): 行号</span>
<span class="sd">            ns (Optional[str], optional): 命名空间. Defaults to None.</span>
<span class="sd">            columns (Optional[Sequence[str]], optional): 想要删除值的列,以&quot;列簇:列名&quot;的形式表达. Defaults to None.</span>
<span class="sd">            timestamp (Optional[datetime.datetime], optional): 指定时间戳. Defaults to None.</span>
<span class="sd">            deleteType (Optional[str], optional): 指定删除类型,可选为DELETE_COLUMN-删除指定列,DELETE_COLUMNS-删除所有列,DELETE_FAMILY-删除指定列簇,DELETE_FAMILY_VERSION-删除指定列簇的指定版本. Defaults to DELETE_COLUMNS.</span>
<span class="sd">            attributes (Optional[Dict[str, bytes]], optional): 指定属性. Defaults to None.</span>
<span class="sd">            durability (Optional[str], optional): 指定耐久方式设置,可选的有USE_DEFAULT,SKIP_WAL,ASYNC_WAL,SYNC_WAL,FSYNC_WAL.Defaults to None.</span>
<span class="sd">            check_row (Optional[str], optional): 待监测行名</span>
<span class="sd">            check_column_full_name (Optional[str], optional): 待检查的列,以`列簇:列名`形式表示,如果有指定`column_value`则检查指定列的值是否和`column_value`指定的相同,否则检查指定列是否存在.</span>
<span class="sd">            check_column_value (Optional[bytes], optional): 指定检查列应该满足的值.</span>


<span class="sd">        Raises:</span>
<span class="sd">            AttributeError: 表名格式不合法</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ns</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tableNameInbytes</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ns</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tabelinfo</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tabelinfo</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">tableNameInbytes</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;parameter table syntax error: </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">row_bytes</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span>
        <span class="n">_columns</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">columns</span><span class="p">:</span>
            <span class="n">_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">TColumn</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">qualifier</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">else</span> <span class="n">TColumn</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">]</span>

        <span class="n">_timestamp</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">timestamp</span><span class="p">:</span>
            <span class="n">_timestamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">timestamp</span><span class="o">.</span><span class="n">timestamp</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>
        <span class="n">_deleteType</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">deleteType</span><span class="p">:</span>
            <span class="n">_deleteType</span> <span class="o">=</span> <span class="n">TDeleteType</span><span class="o">.</span><span class="n">_NAMES_TO_VALUES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">deleteType</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">_attributes</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">attributes</span><span class="p">:</span>
            <span class="n">_attributes</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">):</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">attributes</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
        <span class="n">_durability</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">durability</span><span class="p">:</span>
            <span class="n">_durability</span> <span class="o">=</span> <span class="n">TDurability</span><span class="o">.</span><span class="n">_NAMES_TO_VALUES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">durability</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">check_row</span> <span class="ow">and</span> <span class="n">check_column_full_name</span><span class="p">:</span>
            <span class="n">check_row_bytes</span> <span class="o">=</span> <span class="n">check_row</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span>
            <span class="n">family</span><span class="p">,</span> <span class="n">cloumn</span> <span class="o">=</span> <span class="n">check_column_full_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">checkAndDelete</span><span class="p">(</span>
                <span class="n">table</span><span class="o">=</span><span class="n">tableNameInbytes</span><span class="p">,</span>
                <span class="n">row</span><span class="o">=</span><span class="n">check_row_bytes</span><span class="p">,</span>
                <span class="n">family</span><span class="o">=</span><span class="n">family</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">),</span>
                <span class="n">qualifier</span><span class="o">=</span><span class="n">cloumn</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">),</span>
                <span class="n">value</span><span class="o">=</span><span class="n">check_column_value</span><span class="p">,</span>
                <span class="n">tdelete</span><span class="o">=</span><span class="n">TDelete</span><span class="p">(</span>
                    <span class="n">row</span><span class="o">=</span><span class="n">row_bytes</span><span class="p">,</span>
                    <span class="n">columns</span><span class="o">=</span><span class="n">_columns</span><span class="p">,</span>
                    <span class="n">timestamp</span><span class="o">=</span><span class="n">_timestamp</span><span class="p">,</span>
                    <span class="n">deleteType</span><span class="o">=</span><span class="n">_deleteType</span><span class="p">,</span>
                    <span class="n">attributes</span><span class="o">=</span><span class="n">_attributes</span><span class="p">,</span>
                    <span class="n">durability</span><span class="o">=</span><span class="n">_durability</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">deleteSingle</span><span class="p">(</span>
                <span class="n">table</span><span class="o">=</span><span class="n">tableNameInbytes</span><span class="p">,</span>
                <span class="n">tdelete</span><span class="o">=</span><span class="n">TDelete</span><span class="p">(</span>
                    <span class="n">row</span><span class="o">=</span><span class="n">row_bytes</span><span class="p">,</span>
                    <span class="n">columns</span><span class="o">=</span><span class="n">_columns</span><span class="p">,</span>
                    <span class="n">timestamp</span><span class="o">=</span><span class="n">_timestamp</span><span class="p">,</span>
                    <span class="n">deleteType</span><span class="o">=</span><span class="n">_deleteType</span><span class="p">,</span>
                    <span class="n">attributes</span><span class="o">=</span><span class="n">_attributes</span><span class="p">,</span>
                    <span class="n">durability</span><span class="o">=</span><span class="n">_durability</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">batch_put</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">rkvs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">ColumnsValue</span><span class="p">],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">],</span> <span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">ColumnsValue</span><span class="p">]]]]],</span> <span class="o">*</span><span class="p">,</span> <span class="n">ns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;批量插入</span>

<span class="sd">        Args:</span>
<span class="sd">            table(str): 表名, 表名中如果是&quot;ns:table&quot;的形式已经指定了命名空间则可以不填ns参数</span>
<span class="sd">            rkvs ( Dict[str, Union[List[ColumnsValue], Dict[str, Union[datetime.datetime, Dict[str, bytes], str, List[ColumnsValue]]]]]): 行名与传入的值序列构成的字典或者行名与参数字典组成的字典,参数范围参照put</span>
<span class="sd">            ns(Optional[str], optional): 命名空间名称</span>

<span class="sd">        Raises:</span>
<span class="sd">            AttributeError: 表名格式不合法</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ns</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tableNameInbytes</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ns</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tabelinfo</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tabelinfo</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">tableNameInbytes</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;parameter table syntax error: </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">puts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">row</span><span class="p">,</span> <span class="n">kvs</span> <span class="ow">in</span> <span class="n">rkvs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kvs</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">p</span> <span class="o">=</span> <span class="n">TPut</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">),</span> <span class="n">columnValues</span><span class="o">=</span><span class="p">[</span><span class="n">kv</span><span class="o">.</span><span class="n">as_TColumnValue</span><span class="p">()</span> <span class="k">for</span> <span class="n">kv</span> <span class="ow">in</span> <span class="n">kvs</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">_timestamp</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">timestamp</span> <span class="o">=</span> <span class="n">kvs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;timestamp&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">timestamp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">timestamp</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">):</span>
                    <span class="n">_timestamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">timestamp</span><span class="o">.</span><span class="n">timestamp</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>
                <span class="n">_attributes</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">attributes</span> <span class="o">=</span> <span class="n">kvs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;attributes&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">attributes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attributes</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                    <span class="n">_attributes</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">):</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">attributes</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
                <span class="n">_durability</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">durability</span> <span class="o">=</span> <span class="n">kvs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;durability&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">durability</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">durability</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="n">_durability</span> <span class="o">=</span> <span class="n">TDurability</span><span class="o">.</span><span class="n">_NAMES_TO_VALUES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">durability</span><span class="p">)</span>
                <span class="n">_cellVisibility</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">cellVisibility</span> <span class="o">=</span> <span class="n">kvs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;cellVisibility&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">cellVisibility</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cellVisibility</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="n">_cellVisibility</span> <span class="o">=</span> <span class="n">TCellVisibility</span><span class="p">(</span><span class="n">expression</span><span class="o">=</span><span class="n">cellVisibility</span><span class="p">)</span>

                <span class="n">_kvs</span> <span class="o">=</span> <span class="n">kvs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;kvs&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">_kvs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">_kvs</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;not set kvs&quot;</span><span class="p">)</span>
                <span class="n">p</span> <span class="o">=</span> <span class="n">TPut</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">),</span>
                         <span class="n">columnValues</span><span class="o">=</span><span class="p">[</span><span class="n">kv</span><span class="o">.</span><span class="n">as_TColumnValue</span><span class="p">()</span> <span class="k">for</span> <span class="n">kv</span> <span class="ow">in</span> <span class="n">_kvs</span><span class="p">],</span>
                         <span class="n">timestamp</span><span class="o">=</span><span class="n">_timestamp</span><span class="p">,</span>
                         <span class="n">attributes</span><span class="o">=</span><span class="n">_attributes</span><span class="p">,</span>
                         <span class="n">durability</span><span class="o">=</span><span class="n">_durability</span><span class="p">,</span>
                         <span class="n">cellVisibility</span><span class="o">=</span><span class="n">_cellVisibility</span><span class="p">)</span>
            <span class="n">puts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">putMultiple</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="n">tableNameInbytes</span><span class="p">,</span> <span class="n">tputs</span><span class="o">=</span><span class="n">puts</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">batch_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">rows</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="o">*</span><span class="p">,</span>
                     <span class="n">ns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                     <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                     <span class="n">timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                     <span class="n">deleteType</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                     <span class="n">attributes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                     <span class="n">durability</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;批量删除.</span>

<span class="sd">        Args:</span>
<span class="sd">            table (str): 表名, 表名中如果是&quot;ns:table&quot;的形式已经指定了命名空间则可以不填ns参数</span>
<span class="sd">            rows (List[str]): 要删除数据的行.</span>
<span class="sd">            ns (Optional[str], optional): 命名空间. Defaults to None.</span>
<span class="sd">            columns (Optional[Sequence[str]], optional): 想要删除值的列,以&quot;列簇:列名&quot;的形式表达. Defaults to None.</span>
<span class="sd">            timestamp (Optional[datetime.datetime], optional): 指定时间戳. Defaults to None.</span>
<span class="sd">            deleteType (Optional[str], optional): 指定删除类型,可选为DELETE_COLUMN-删除指定列,DELETE_COLUMNS-删除所有列,DELETE_FAMILY-删除指定列簇,DELETE_FAMILY_VERSION-删除指定列簇的指定版本. Defaults to DELETE_COLUMNS.</span>
<span class="sd">            attributes (Optional[Dict[str, bytes]], optional): 指定属性. Defaults to None.</span>
<span class="sd">            durability (Optional[str], optional): 指定耐久方式设置,可选的有USE_DEFAULT,SKIP_WAL,ASYNC_WAL,SYNC_WAL,FSYNC_WAL.Defaults to None.</span>

<span class="sd">        Raises:</span>
<span class="sd">            AttributeError: _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ns</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tableNameInbytes</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ns</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tabelinfo</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tabelinfo</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">tableNameInbytes</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;parameter table syntax error: </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">_columns</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">columns</span><span class="p">:</span>
            <span class="n">_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">TColumn</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">qualifier</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">else</span> <span class="n">TColumn</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">]</span>

        <span class="n">_timestamp</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">timestamp</span><span class="p">:</span>
            <span class="n">_timestamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">timestamp</span><span class="o">.</span><span class="n">timestamp</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>
        <span class="n">_deleteType</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">deleteType</span><span class="p">:</span>
            <span class="n">_deleteType</span> <span class="o">=</span> <span class="n">TDeleteType</span><span class="o">.</span><span class="n">_NAMES_TO_VALUES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">deleteType</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">_attributes</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">attributes</span><span class="p">:</span>
            <span class="n">_attributes</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">):</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">attributes</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
        <span class="n">_durability</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">durability</span><span class="p">:</span>
            <span class="n">_durability</span> <span class="o">=</span> <span class="n">TDurability</span><span class="o">.</span><span class="n">_NAMES_TO_VALUES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">durability</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">deleteMultiple</span><span class="p">(</span>
            <span class="n">table</span><span class="o">=</span><span class="n">tableNameInbytes</span><span class="p">,</span>
            <span class="n">tdeletes</span><span class="o">=</span><span class="p">[</span><span class="n">TDelete</span><span class="p">(</span>
                <span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">),</span>
                <span class="n">columns</span><span class="o">=</span><span class="n">_columns</span><span class="p">,</span>
                <span class="n">timestamp</span><span class="o">=</span><span class="n">_timestamp</span><span class="p">,</span>
                <span class="n">deleteType</span><span class="o">=</span><span class="n">_deleteType</span><span class="p">,</span>
                <span class="n">attributes</span><span class="o">=</span><span class="n">_attributes</span><span class="p">,</span>
                <span class="n">durability</span><span class="o">=</span><span class="n">_durability</span>
            <span class="p">)</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">]</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">row</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">kvs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">ColumnsValue</span><span class="p">],</span> <span class="o">*</span><span class="p">,</span>
               <span class="n">ns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">attributes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">durability</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">cellVisibility</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">returnResults</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
               <span class="n">columns_decoder</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">bytes</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]],</span> <span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">ColumnsValue</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;追加列数据.</span>

<span class="sd">        在不改变原有数据的情况下追加数据,相当于get-&gt;put的原子操作.</span>

<span class="sd">        注意追加的是bytes,比如原本数据是`3`,追加`2`后会变成`32`</span>

<span class="sd">        Args:</span>
<span class="sd">            table (str): 表名, 表名中如果是&quot;ns:table&quot;的形式已经指定了命名空间则可以不填ns参数</span>
<span class="sd">            row (str): 行名</span>
<span class="sd">            kvs (List[ColumnsValue]): 传入的值序列</span>
<span class="sd">            ns (Optional[str], optional): 命名空间名称. Defaults to None.</span>
<span class="sd">            attributes (Optional[Dict[str, bytes]], optional): 指定属性. Defaults to None.</span>
<span class="sd">            durability (Optional[str], optional): 指定耐久方式设置,可选的有USE_DEFAULT,SKIP_WAL,ASYNC_WAL,SYNC_WAL,FSYNC_WAL.Defaults to None.</span>
<span class="sd">            cellVisibility (Optional[str], optional): cell的可视性设置. Defaults to None.</span>
<span class="sd">            returnResults (bool): 是否返回结果. Defaults to False.</span>
<span class="sd">            columns_decoder (Optional[Mapping[str, Callable[[bytes, Optional[bytes]], Any]]], optional): _description_. Defaults to None.</span>

<span class="sd">        Raises:</span>
<span class="sd">            AttributeError: 表名格式不合法</span>

<span class="sd">        Returns:</span>
<span class="sd">            Optional[List[ColumnsValue]]: 结果序列</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ns</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tableNameInbytes</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ns</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tabelinfo</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tabelinfo</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">tableNameInbytes</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;parameter table syntax error: </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">row_bytes</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span>
        <span class="n">_columns</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">kvs</span><span class="p">:</span>
            <span class="n">_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">kv</span><span class="o">.</span><span class="n">as_TColumnValue</span><span class="p">()</span> <span class="k">for</span> <span class="n">kv</span> <span class="ow">in</span> <span class="n">kvs</span><span class="p">]</span>
        <span class="n">_attributes</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">attributes</span><span class="p">:</span>
            <span class="n">_attributes</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">):</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">attributes</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
        <span class="n">_durability</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">durability</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_durability</span> <span class="o">=</span> <span class="n">TDurability</span><span class="o">.</span><span class="n">_NAMES_TO_VALUES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">durability</span><span class="p">)</span>
        <span class="n">_cellVisibility</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">cellVisibility</span><span class="p">:</span>
            <span class="n">_cellVisibility</span> <span class="o">=</span> <span class="n">TCellVisibility</span><span class="p">(</span><span class="n">expression</span><span class="o">=</span><span class="n">cellVisibility</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">table</span><span class="o">=</span><span class="n">tableNameInbytes</span><span class="p">,</span>
            <span class="n">tappend</span><span class="o">=</span><span class="n">TAppend</span><span class="p">(</span>
                <span class="n">row</span><span class="o">=</span><span class="n">row_bytes</span><span class="p">,</span>
                <span class="n">columns</span><span class="o">=</span><span class="n">_columns</span><span class="p">,</span>
                <span class="n">attributes</span><span class="o">=</span><span class="n">_attributes</span><span class="p">,</span>
                <span class="n">durability</span><span class="o">=</span><span class="n">_durability</span><span class="p">,</span>
                <span class="n">cellVisibility</span><span class="o">=</span><span class="n">_cellVisibility</span><span class="p">,</span>
                <span class="n">returnResults</span><span class="o">=</span><span class="n">returnResults</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">row</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">tcv</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">columnValues</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">columns_decoder</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">family</span> <span class="o">=</span> <span class="n">tcv</span><span class="o">.</span><span class="n">family</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
                    <span class="n">col</span> <span class="o">=</span> <span class="n">tcv</span><span class="o">.</span><span class="n">qualifier</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
                    <span class="n">col_name</span> <span class="o">=</span> <span class="n">fullcolumn</span><span class="p">(</span><span class="n">family</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
                    <span class="n">decoder</span> <span class="o">=</span> <span class="n">columns_decoder</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span>
                    <span class="n">cv</span> <span class="o">=</span> <span class="n">ColumnsValue</span><span class="p">(</span><span class="n">decoder</span><span class="o">=</span><span class="n">decoder</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">cv</span> <span class="o">=</span> <span class="n">ColumnsValue</span><span class="p">()</span>
                <span class="n">cv</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">tcv</span><span class="p">)</span>
                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cv</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">res</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">increment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">row</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">kvs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                  <span class="n">ns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                  <span class="n">attributes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                  <span class="n">durability</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                  <span class="n">cellVisibility</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                  <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;原子性的自增.</span>

<span class="sd">        相当于get-&gt;+n-&gt;put的原子操作.注意自增存储依然是在bytes上,因此并不能直接获得整型数,需要将bytes转为16进制字符串再转为10进制数据</span>

<span class="sd">        Args:</span>
<span class="sd">            table (str): 表名, 表名中如果是&quot;ns:table&quot;的形式已经指定了命名空间则可以不填ns参数</span>
<span class="sd">            row (str): 行名</span>
<span class="sd">            kvs (Optional[Dict[str, int]], optional): 列名与增量的映射关系,当增量设置为0或者为空时使用默认的1作为增量. Defaults to None.</span>
<span class="sd">            ns (Optional[str], optional): 命名空间名称. Defaults to None.</span>
<span class="sd">            attributes (Optional[Dict[str, bytes]], optional): 指定属性. Defaults to None.</span>
<span class="sd">            durability (Optional[str], optional): 指定耐久方式设置,可选的有USE_DEFAULT,SKIP_WAL,ASYNC_WAL,SYNC_WAL,FSYNC_WAL.Defaults to None.</span>
<span class="sd">            cellVisibility (Optional[str], optional): cell的可视性设置. Defaults to None.</span>

<span class="sd">        Raises:</span>
<span class="sd">            AttributeError: 表名格式不合法</span>

<span class="sd">        Returns:</span>
<span class="sd">            Optional[List[ColumnsValue]]: 结果序列</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ns</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tableNameInbytes</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ns</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tabelinfo</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tabelinfo</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">tableNameInbytes</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;parameter table syntax error: </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">row_bytes</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span>
        <span class="n">_columns</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">kvs</span><span class="p">:</span>
            <span class="n">_columns</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kvs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">f</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">v</span><span class="p">:</span>
                    <span class="n">_columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">TColumnIncrement</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">),</span> <span class="n">qualifier</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">),</span> <span class="n">amount</span><span class="o">=</span><span class="n">v</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">_columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">TColumnIncrement</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">),</span> <span class="n">qualifier</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)))</span>
        <span class="n">_attributes</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">attributes</span><span class="p">:</span>
            <span class="n">_attributes</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">):</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">attributes</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
        <span class="n">_durability</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">durability</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_durability</span> <span class="o">=</span> <span class="n">TDurability</span><span class="o">.</span><span class="n">_NAMES_TO_VALUES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">durability</span><span class="p">)</span>
        <span class="n">_cellVisibility</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">cellVisibility</span><span class="p">:</span>
            <span class="n">_cellVisibility</span> <span class="o">=</span> <span class="n">TCellVisibility</span><span class="p">(</span><span class="n">expression</span><span class="o">=</span><span class="n">cellVisibility</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">increment</span><span class="p">(</span>
            <span class="n">table</span><span class="o">=</span><span class="n">tableNameInbytes</span><span class="p">,</span>
            <span class="n">tincrement</span><span class="o">=</span><span class="n">TIncrement</span><span class="p">(</span>
                <span class="n">row</span><span class="o">=</span><span class="n">row_bytes</span><span class="p">,</span>
                <span class="n">columns</span><span class="o">=</span><span class="n">_columns</span><span class="p">,</span>
                <span class="n">attributes</span><span class="o">=</span><span class="n">_attributes</span><span class="p">,</span>
                <span class="n">durability</span><span class="o">=</span><span class="n">_durability</span><span class="p">,</span>
                <span class="n">cellVisibility</span><span class="o">=</span><span class="n">_cellVisibility</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">tcv</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">columnValues</span><span class="p">:</span>
            <span class="n">family</span> <span class="o">=</span> <span class="n">tcv</span><span class="o">.</span><span class="n">family</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
            <span class="n">col</span> <span class="o">=</span> <span class="n">tcv</span><span class="o">.</span><span class="n">qualifier</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
            <span class="n">col_name</span> <span class="o">=</span> <span class="n">fullcolumn</span><span class="p">(</span><span class="n">family</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">NumberDecoder</span><span class="p">(</span><span class="n">tcv</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="n">res</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span> <span class="n">res</span>

    <span class="k">def</span> <span class="nf">mutation_session</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">row</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                         <span class="n">ns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                         <span class="n">check_row</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                         <span class="n">check_column_full_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                         <span class="n">check_compare_op</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                         <span class="n">check_column_value</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MutationSession</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;创建一个mutation会话.</span>

<span class="sd">        Args:</span>
<span class="sd">            table (str): 指定会话指向的表,表名中如果是&quot;ns:table&quot;的形式已经指定了命名空间则可以不填ns参数</span>
<span class="sd">            row (str): 指向会话指向的行</span>
<span class="sd">            ns (Optional[str], optional): 命名空间. Defaults to None.</span>
<span class="sd">            check_row (Optional[str], optional): 待监测行名</span>
<span class="sd">            check_column_full_name (Optional[str], optional): 待检查的列,以`列簇:列名`形式表示,如果有指定`column_value`则检查指定列的值是否和`column_value`指定的相同,否则检查指定列是否存在.</span>
<span class="sd">            check_column_value (Optional[bytes], optional): 指定检查列的值与之执行对比操作的值.</span>
<span class="sd">            check_compare_op (Optional[str], optional): 指定对比操作,可选的有LESS,LESS_OR_EQUAL,EQUAL,NOT_EQUAL,GREATER_OR_EQUAL,GREATER,NO_OP. Defaults to None.</span>

<span class="sd">        Raises:</span>
<span class="sd">            AttributeError: 表名格式不合法</span>

<span class="sd">        Returns:</span>
<span class="sd">            MutationSession: mutation会话对象</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ms</span> <span class="o">=</span> <span class="n">MutationSession</span><span class="p">(</span>
            <span class="n">cli</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">table</span><span class="o">=</span><span class="n">table</span><span class="p">,</span>
            <span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span>
            <span class="n">ns</span><span class="o">=</span><span class="n">ns</span><span class="p">,</span>
            <span class="n">check_row</span><span class="o">=</span><span class="n">check_row</span><span class="p">,</span>
            <span class="n">check_column_full_name</span><span class="o">=</span><span class="n">check_column_full_name</span><span class="p">,</span>
            <span class="n">check_compare_op</span><span class="o">=</span><span class="n">check_compare_op</span><span class="p">,</span>
            <span class="n">check_column_value</span><span class="o">=</span><span class="n">check_column_value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ms</span>

    <span class="c1"># 读操作</span>
    <span class="k">def</span> <span class="nf">exists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">row</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
               <span class="n">ns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">timeRange</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">maxVersions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">filterString</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">attributes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">authorizations</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">consistency</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">targetReplicaId</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">cacheBlocks</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">storeLimit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">storeOffset</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">existence_only</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">filterBytes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
               <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;查看指定行是否存在.</span>

<span class="sd">        Example:</span>

<span class="sd">            isin = cli.exists(tablefullname, row)</span>

<span class="sd">        Args:</span>
<span class="sd">            table (str): 表名, 表名中如果是&quot;ns:table&quot;的形式已经指定了命名空间则可以不填ns参数</span>
<span class="sd">            row (str): 行号</span>
<span class="sd">            ns (Optional[str], optional):命名空间. Defaults to None.</span>
<span class="sd">            columns (Optional[Sequence[str]], optional): 想要获取的列,以&quot;列簇:列名&quot;的形式表达. Defaults to None.</span>
<span class="sd">            timestamp (Optional[datetime.datetime], optional): 指定时间戳. Defaults to None.</span>
<span class="sd">            timeRange (Optional[Tuple[datetime.datetime, datetime.datetime]], optional): 指定时间范围. Defaults to None.</span>
<span class="sd">            maxVersions (Optional[int], optional): 指定最大版本号. Defaults to None.</span>
<span class="sd">            filterString (Optional[str], optional): 指定过滤字符串. Defaults to None.</span>
<span class="sd">            attributes (Optional[Dict[str, bytes]], optional): 指定属性. Defaults to None.</span>
<span class="sd">            authorizations (Optional[List[str]], optional): 指定认证信息. Defaults to None.</span>
<span class="sd">            consistency (Optional[str], optional): 指定一致性,可选的有STRONG,TIMELINE. Defaults to None.</span>
<span class="sd">            targetReplicaId (Optional[int], optional): 指定副本丢失修复方法. Defaults to None.</span>
<span class="sd">            cacheBlocks (Optional[bool], optional): 指定缓存块. Defaults to None.</span>
<span class="sd">            storeLimit (Optional[int], optional): 指定存储限制. Defaults to None.</span>
<span class="sd">            storeOffset (Optional[int], optional): 指定存储偏移量. Defaults to None.</span>
<span class="sd">            existence_only (Optional[bool], optional): 指定是否只或许已经存在的. Defaults to None.</span>
<span class="sd">            filterBytes (Optional[bytes], optional): 过滤字节流. Defaults to None.</span>

<span class="sd">        Raises:</span>
<span class="sd">            AttributeError: 表名格式错误</span>

<span class="sd">        Returns:</span>
<span class="sd">            List[ColumnsValue]: 结果列表</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ns</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tableNameInbytes</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ns</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tabelinfo</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tabelinfo</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">tableNameInbytes</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;parameter table syntax error: </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">row_bytes</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span>
        <span class="n">_columns</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">columns</span><span class="p">:</span>
            <span class="n">_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">TColumn</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">qualifier</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">else</span> <span class="n">TColumn</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">]</span>

        <span class="n">_timestamp</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">timestamp</span><span class="p">:</span>
            <span class="n">_timestamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">timestamp</span><span class="o">.</span><span class="n">timestamp</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>
        <span class="n">_timeRange</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">timeRange</span><span class="p">:</span>
            <span class="n">_timeRange</span> <span class="o">=</span> <span class="n">TTimeRange</span><span class="p">(</span><span class="n">minStamp</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">timeRange</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">timestamp</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">),</span>
                                    <span class="n">maxStamp</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">timeRange</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">timestamp</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">))</span>

        <span class="n">_filterString</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">filterString</span><span class="p">:</span>
            <span class="n">_filterString</span> <span class="o">=</span> <span class="n">filterString</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
        <span class="n">_attributes</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">attributes</span><span class="p">:</span>
            <span class="n">_attributes</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">):</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">attributes</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

        <span class="n">_authorizations</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">authorizations</span><span class="p">:</span>
            <span class="n">_authorizations</span> <span class="o">=</span> <span class="n">TAuthorization</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="n">authorizations</span><span class="p">)</span>

        <span class="n">_consistency</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">consistency</span><span class="p">:</span>
            <span class="n">_consistency</span> <span class="o">=</span> <span class="n">TConsistency</span><span class="o">.</span><span class="n">_NAMES_TO_VALUES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">consistency</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span>
            <span class="n">table</span><span class="o">=</span><span class="n">tableNameInbytes</span><span class="p">,</span>
            <span class="n">tget</span><span class="o">=</span><span class="n">TGet</span><span class="p">(</span>
                <span class="n">row</span><span class="o">=</span><span class="n">row_bytes</span><span class="p">,</span>
                <span class="n">columns</span><span class="o">=</span><span class="n">_columns</span><span class="p">,</span>
                <span class="n">timestamp</span><span class="o">=</span><span class="n">_timestamp</span><span class="p">,</span>
                <span class="n">timeRange</span><span class="o">=</span><span class="n">_timeRange</span><span class="p">,</span>
                <span class="n">maxVersions</span><span class="o">=</span><span class="n">maxVersions</span><span class="p">,</span>
                <span class="n">filterString</span><span class="o">=</span><span class="n">_filterString</span><span class="p">,</span>
                <span class="n">attributes</span><span class="o">=</span><span class="n">_attributes</span><span class="p">,</span>
                <span class="n">authorizations</span><span class="o">=</span><span class="n">_authorizations</span><span class="p">,</span>
                <span class="n">consistency</span><span class="o">=</span><span class="n">_consistency</span><span class="p">,</span>
                <span class="n">targetReplicaId</span><span class="o">=</span><span class="n">targetReplicaId</span><span class="p">,</span>
                <span class="n">cacheBlocks</span><span class="o">=</span><span class="n">cacheBlocks</span><span class="p">,</span>
                <span class="n">storeLimit</span><span class="o">=</span><span class="n">storeLimit</span><span class="p">,</span>
                <span class="n">storeOffset</span><span class="o">=</span><span class="n">storeOffset</span><span class="p">,</span>
                <span class="n">existence_only</span><span class="o">=</span><span class="n">existence_only</span><span class="p">,</span>
                <span class="n">filterBytes</span><span class="o">=</span><span class="n">filterBytes</span>
            <span class="p">),</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">row</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
            <span class="n">ns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">timeRange</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">maxVersions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">filterString</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">attributes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">authorizations</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">consistency</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">targetReplicaId</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">cacheBlocks</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">storeLimit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">storeOffset</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">existence_only</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">filterBytes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">columns_decoder</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">bytes</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]],</span> <span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">ColumnsValue</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;获取单条数据.</span>

<span class="sd">        Example:</span>

<span class="sd">            rowcolumns = cli.get(tablefullname, row, columns_decoder=defaultdict(lambda: lambda x, y: int(x.decode(&quot;utf-8&quot;))))</span>

<span class="sd">        Args:</span>
<span class="sd">            table (str): 表名, 表名中如果是&quot;ns:table&quot;的形式已经指定了命名空间则可以不填ns参数</span>
<span class="sd">            row (str): 行号</span>
<span class="sd">            ns (Optional[str], optional):命名空间. Defaults to None.</span>
<span class="sd">            columns (Optional[Sequence[str]], optional): 想要获取的列,以&quot;列簇:列名&quot;的形式表达. Defaults to None.</span>
<span class="sd">            timestamp (Optional[datetime.datetime], optional): 指定时间戳. Defaults to None.</span>
<span class="sd">            timeRange (Optional[Tuple[datetime.datetime, datetime.datetime]], optional): 指定时间范围. Defaults to None.</span>
<span class="sd">            maxVersions (Optional[int], optional): 指定最大版本号. Defaults to None.</span>
<span class="sd">            filterString (Optional[str], optional): 指定过滤字符串. Defaults to None.</span>
<span class="sd">            attributes (Optional[Dict[str, bytes]], optional): 指定属性. Defaults to None.</span>
<span class="sd">            authorizations (Optional[List[str]], optional): 指定认证信息. Defaults to None.</span>
<span class="sd">            consistency (Optional[str], optional): 指定一致性,可选的有STRONG,TIMELINE. Defaults to None.</span>
<span class="sd">            targetReplicaId (Optional[int], optional): 指定副本丢失修复方法. Defaults to None.</span>
<span class="sd">            cacheBlocks (Optional[bool], optional): 指定缓存块. Defaults to None.</span>
<span class="sd">            storeLimit (Optional[int], optional): 指定存储限制. Defaults to None.</span>
<span class="sd">            storeOffset (Optional[int], optional): 指定存储偏移量. Defaults to None.</span>
<span class="sd">            existence_only (Optional[bool], optional): 指定是否只或许已经存在的. Defaults to None.</span>
<span class="sd">            filterBytes (Optional[bytes], optional): 过滤字节流. Defaults to None.</span>
<span class="sd">            columns_decoder (Optional[Mapping[str, Callable[[bytes, Optional[bytes]], Any]]], optional): 列的解码器设置,可以使用defaultdict赋值一个默认解码器. Defaults to None.</span>

<span class="sd">        Raises:</span>
<span class="sd">            AttributeError: 表名格式错误</span>

<span class="sd">        Returns:</span>
<span class="sd">            List[ColumnsValue]: 结果列表</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ns</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tableNameInbytes</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ns</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tabelinfo</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tabelinfo</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">tableNameInbytes</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;parameter table syntax error: </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">row_bytes</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span>
        <span class="n">_columns</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">columns</span><span class="p">:</span>
            <span class="n">_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">TColumn</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">qualifier</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">else</span> <span class="n">TColumn</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">]</span>

        <span class="n">_timestamp</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">timestamp</span><span class="p">:</span>
            <span class="n">_timestamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">timestamp</span><span class="o">.</span><span class="n">timestamp</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>
        <span class="n">_timeRange</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">timeRange</span><span class="p">:</span>
            <span class="n">_timeRange</span> <span class="o">=</span> <span class="n">TTimeRange</span><span class="p">(</span><span class="n">minStamp</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">timeRange</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">timestamp</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">),</span>
                                    <span class="n">maxStamp</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">timeRange</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">timestamp</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">))</span>

        <span class="n">_filterString</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">filterString</span><span class="p">:</span>
            <span class="n">_filterString</span> <span class="o">=</span> <span class="n">filterString</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
        <span class="n">_attributes</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">attributes</span><span class="p">:</span>
            <span class="n">_attributes</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">):</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">attributes</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

        <span class="n">_authorizations</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">authorizations</span><span class="p">:</span>
            <span class="n">_authorizations</span> <span class="o">=</span> <span class="n">TAuthorization</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="n">authorizations</span><span class="p">)</span>

        <span class="n">_consistency</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">consistency</span><span class="p">:</span>
            <span class="n">_consistency</span> <span class="o">=</span> <span class="n">TConsistency</span><span class="o">.</span><span class="n">_NAMES_TO_VALUES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">consistency</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="n">table</span><span class="o">=</span><span class="n">tableNameInbytes</span><span class="p">,</span>
            <span class="n">tget</span><span class="o">=</span><span class="n">TGet</span><span class="p">(</span>
                <span class="n">row</span><span class="o">=</span><span class="n">row_bytes</span><span class="p">,</span>
                <span class="n">columns</span><span class="o">=</span><span class="n">_columns</span><span class="p">,</span>
                <span class="n">timestamp</span><span class="o">=</span><span class="n">_timestamp</span><span class="p">,</span>
                <span class="n">timeRange</span><span class="o">=</span><span class="n">_timeRange</span><span class="p">,</span>
                <span class="n">maxVersions</span><span class="o">=</span><span class="n">maxVersions</span><span class="p">,</span>
                <span class="n">filterString</span><span class="o">=</span><span class="n">_filterString</span><span class="p">,</span>
                <span class="n">attributes</span><span class="o">=</span><span class="n">_attributes</span><span class="p">,</span>
                <span class="n">authorizations</span><span class="o">=</span><span class="n">_authorizations</span><span class="p">,</span>
                <span class="n">consistency</span><span class="o">=</span><span class="n">_consistency</span><span class="p">,</span>
                <span class="n">targetReplicaId</span><span class="o">=</span><span class="n">targetReplicaId</span><span class="p">,</span>
                <span class="n">cacheBlocks</span><span class="o">=</span><span class="n">cacheBlocks</span><span class="p">,</span>
                <span class="n">storeLimit</span><span class="o">=</span><span class="n">storeLimit</span><span class="p">,</span>
                <span class="n">storeOffset</span><span class="o">=</span><span class="n">storeOffset</span><span class="p">,</span>
                <span class="n">existence_only</span><span class="o">=</span><span class="n">existence_only</span><span class="p">,</span>
                <span class="n">filterBytes</span><span class="o">=</span><span class="n">filterBytes</span>
            <span class="p">),</span>
        <span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">row</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">tcv</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">columnValues</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">columns_decoder</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">family</span> <span class="o">=</span> <span class="n">tcv</span><span class="o">.</span><span class="n">family</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
                    <span class="n">col</span> <span class="o">=</span> <span class="n">tcv</span><span class="o">.</span><span class="n">qualifier</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
                    <span class="n">col_name</span> <span class="o">=</span> <span class="n">fullcolumn</span><span class="p">(</span><span class="n">family</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
                    <span class="n">decoder</span> <span class="o">=</span> <span class="n">columns_decoder</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span>
                    <span class="c1"># cv.regist_decoder(decoder)</span>
                    <span class="n">cv</span> <span class="o">=</span> <span class="n">ColumnsValue</span><span class="p">(</span><span class="n">decoder</span><span class="o">=</span><span class="n">decoder</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">cv</span> <span class="o">=</span> <span class="n">ColumnsValue</span><span class="p">()</span>
                <span class="n">cv</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">tcv</span><span class="p">)</span>
                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cv</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">res</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">batch_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">rows</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="o">*</span><span class="p">,</span>
                  <span class="n">ns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                  <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                  <span class="n">timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                  <span class="n">timeRange</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                  <span class="n">maxVersions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                  <span class="n">filterString</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                  <span class="n">attributes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                  <span class="n">authorizations</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                  <span class="n">consistency</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                  <span class="n">targetReplicaId</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                  <span class="n">cacheBlocks</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                  <span class="n">storeLimit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                  <span class="n">storeOffset</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                  <span class="n">existence_only</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                  <span class="n">filterBytes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                  <span class="n">columns_decoder</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">bytes</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]],</span> <span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                  <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">ColumnsValue</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;获取单条数据.</span>

<span class="sd">        Example:</span>

<span class="sd">            rowcolumns = cli.get(tablefullname, row, columns_decoder=defaultdict(lambda: lambda x, y: int(x.decode(&quot;utf-8&quot;))))</span>

<span class="sd">        Args:</span>
<span class="sd">            table (str): 表名, 表名中如果是&quot;ns:table&quot;的形式已经指定了命名空间则可以不填ns参数</span>
<span class="sd">            rows (str): 行号列表</span>
<span class="sd">            ns (Optional[str], optional):命名空间. Defaults to None.</span>
<span class="sd">            columns (Optional[Sequence[str]], optional): 想要获取的列,以&quot;列簇:列名&quot;的形式表达. Defaults to None.</span>
<span class="sd">            timestamp (Optional[datetime.datetime], optional): 指定时间戳. Defaults to None.</span>
<span class="sd">            timeRange (Optional[Tuple[datetime.datetime, datetime.datetime]], optional): 指定时间范围. Defaults to None.</span>
<span class="sd">            maxVersions (Optional[int], optional): 指定最大版本号. Defaults to None.</span>
<span class="sd">            filterString (Optional[str], optional): 指定过滤字符串. Defaults to None.</span>
<span class="sd">            attributes (Optional[Dict[str, bytes]], optional): 指定属性. Defaults to None.</span>
<span class="sd">            authorizations (Optional[List[str]], optional): 指定认证信息. Defaults to None.</span>
<span class="sd">            consistency (Optional[str], optional): 指定一致性,可选的有STRONG,TIMELINE. Defaults to None.</span>
<span class="sd">            targetReplicaId (Optional[int], optional): 指定副本丢失修复方法. Defaults to None.</span>
<span class="sd">            cacheBlocks (Optional[bool], optional): 指定缓存块. Defaults to None.</span>
<span class="sd">            storeLimit (Optional[int], optional): 指定存储限制. Defaults to None.</span>
<span class="sd">            storeOffset (Optional[int], optional): 指定存储偏移量. Defaults to None.</span>
<span class="sd">            existence_only (Optional[bool], optional): 指定是否只或许已经存在的. Defaults to None.</span>
<span class="sd">            filterBytes (Optional[bytes], optional): 过滤字节流. Defaults to None.</span>
<span class="sd">            columns_decoder (Optional[Mapping[str, Callable[[bytes, Optional[bytes]], Any]]], optional): 列的解码器设置,可以使用defaultdict赋值一个默认解码器. Defaults to None.</span>

<span class="sd">        Raises:</span>
<span class="sd">            AttributeError: 表名格式错误</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict[str, List[ColumnsValue]]: 结果列表</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ns</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tableNameInbytes</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ns</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tabelinfo</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tabelinfo</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">tableNameInbytes</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;parameter table syntax error: </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">rows_bytes</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">]</span>
        <span class="n">_columns</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">columns</span><span class="p">:</span>
            <span class="n">_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">TColumn</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">qualifier</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">else</span> <span class="n">TColumn</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">]</span>

        <span class="n">_timestamp</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">timestamp</span><span class="p">:</span>
            <span class="n">_timestamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">timestamp</span><span class="o">.</span><span class="n">timestamp</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>
        <span class="n">_timeRange</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">timeRange</span><span class="p">:</span>
            <span class="n">_timeRange</span> <span class="o">=</span> <span class="n">TTimeRange</span><span class="p">(</span><span class="n">minStamp</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">timeRange</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">timestamp</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">),</span>
                                    <span class="n">maxStamp</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">timeRange</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">timestamp</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">))</span>

        <span class="n">_filterString</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">filterString</span><span class="p">:</span>
            <span class="n">_filterString</span> <span class="o">=</span> <span class="n">filterString</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
        <span class="n">_attributes</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">attributes</span><span class="p">:</span>
            <span class="n">_attributes</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">):</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">attributes</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

        <span class="n">_authorizations</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">authorizations</span><span class="p">:</span>
            <span class="n">_authorizations</span> <span class="o">=</span> <span class="n">TAuthorization</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="n">authorizations</span><span class="p">)</span>

        <span class="n">_consistency</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">consistency</span><span class="p">:</span>
            <span class="n">_consistency</span> <span class="o">=</span> <span class="n">TConsistency</span><span class="o">.</span><span class="n">_NAMES_TO_VALUES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">consistency</span><span class="p">)</span>

        <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">getMultiple</span><span class="p">(</span>
            <span class="n">table</span><span class="o">=</span><span class="n">tableNameInbytes</span><span class="p">,</span>
            <span class="n">tgets</span><span class="o">=</span><span class="p">[</span><span class="n">TGet</span><span class="p">(</span>
                <span class="n">row</span><span class="o">=</span><span class="n">row_bytes</span><span class="p">,</span>
                <span class="n">columns</span><span class="o">=</span><span class="n">_columns</span><span class="p">,</span>
                <span class="n">timestamp</span><span class="o">=</span><span class="n">_timestamp</span><span class="p">,</span>
                <span class="n">timeRange</span><span class="o">=</span><span class="n">_timeRange</span><span class="p">,</span>
                <span class="n">maxVersions</span><span class="o">=</span><span class="n">maxVersions</span><span class="p">,</span>
                <span class="n">filterString</span><span class="o">=</span><span class="n">_filterString</span><span class="p">,</span>
                <span class="n">attributes</span><span class="o">=</span><span class="n">_attributes</span><span class="p">,</span>
                <span class="n">authorizations</span><span class="o">=</span><span class="n">_authorizations</span><span class="p">,</span>
                <span class="n">consistency</span><span class="o">=</span><span class="n">_consistency</span><span class="p">,</span>
                <span class="n">targetReplicaId</span><span class="o">=</span><span class="n">targetReplicaId</span><span class="p">,</span>
                <span class="n">cacheBlocks</span><span class="o">=</span><span class="n">cacheBlocks</span><span class="p">,</span>
                <span class="n">storeLimit</span><span class="o">=</span><span class="n">storeLimit</span><span class="p">,</span>
                <span class="n">storeOffset</span><span class="o">=</span><span class="n">storeOffset</span><span class="p">,</span>
                <span class="n">existence_only</span><span class="o">=</span><span class="n">existence_only</span><span class="p">,</span>
                <span class="n">filterBytes</span><span class="o">=</span><span class="n">filterBytes</span>
            <span class="p">)</span> <span class="k">for</span> <span class="n">row_bytes</span> <span class="ow">in</span> <span class="n">rows_bytes</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">row</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">row_key</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">row</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">tcv</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">columnValues</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">columns_decoder</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">family</span> <span class="o">=</span> <span class="n">tcv</span><span class="o">.</span><span class="n">family</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
                        <span class="n">col</span> <span class="o">=</span> <span class="n">tcv</span><span class="o">.</span><span class="n">qualifier</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
                        <span class="n">col_name</span> <span class="o">=</span> <span class="n">fullcolumn</span><span class="p">(</span><span class="n">family</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
                        <span class="n">decoder</span> <span class="o">=</span> <span class="n">columns_decoder</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span>
                        <span class="c1"># cv.regist_decoder(decoder)</span>
                        <span class="n">cv</span> <span class="o">=</span> <span class="n">ColumnsValue</span><span class="p">(</span><span class="n">decoder</span><span class="o">=</span><span class="n">decoder</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">cv</span> <span class="o">=</span> <span class="n">ColumnsValue</span><span class="p">()</span>
                    <span class="n">cv</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">tcv</span><span class="p">)</span>
                    <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cv</span><span class="p">)</span>
                <span class="n">res</span><span class="p">[</span><span class="n">row_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span>
        <span class="k">return</span> <span class="n">res</span>

    <span class="k">def</span> <span class="nf">scan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
             <span class="n">ns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">startRow</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">stopRow</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">caching</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">maxVersions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
             <span class="n">timeRange</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">filterString</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">batchSize</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">attributes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">authorizations</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="nb">reversed</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">cacheBlocks</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">colFamTimeRangeMap</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">readType</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">limit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">consistency</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">targetReplicaId</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">filterBytes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">rowNum</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
             <span class="n">columns_decoder</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">bytes</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]],</span> <span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">ColumnsValue</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;查询符合要求的行数据.</span>

<span class="sd">        Args:</span>
<span class="sd">            table (str): 表名, 表名中如果是&quot;ns:table&quot;的形式已经指定了命名空间则可以不填ns参数</span>
<span class="sd">            ns (Optional[str], optional): 命名空间. Defaults to None.</span>
<span class="sd">            startRow (Optional[str], optional): 起始行. Defaults to None.</span>
<span class="sd">            stopRow (Optional[str], optional): 结束行. Defaults to None.</span>
<span class="sd">            columns (Optional[Sequence[str]], optional): 想要获取的列,以&quot;列簇:列名&quot;的形式表达. Defaults to None.</span>
<span class="sd">            caching (Optional[int], optional): 缓存大小. Defaults to None.</span>
<span class="sd">            maxVersions (Optional[int], optional): 数据最大版本. Defaults to 1.</span>
<span class="sd">            timeRange (Optional[Tuple[datetime.datetime, datetime.datetime]], optional): 查找时间范围. Defaults to None.</span>
<span class="sd">            filterString (Optional[str], optional): 查询字符串. Defaults to None.</span>
<span class="sd">            batchSize (Optional[int], optional): 批大小. Defaults to None.</span>
<span class="sd">            attributes (Optional[Dict[str, bytes]], optional): 属性字典. Defaults to None.</span>
<span class="sd">            authorizations (Optional[List[str]], optional): 验证信息. Defaults to None.</span>
<span class="sd">            reversed (Optional[bool], optional): 排序反转. Defaults to None.</span>
<span class="sd">            cacheBlocks (Optional[bool], optional): 缓存块. Defaults to None.</span>
<span class="sd">            colFamTimeRangeMap (Optional[Dict[str, Tuple[datetime.datetime, datetime.datetime]]], optional): 列簇查找时间范围. Defaults to None.</span>
<span class="sd">            readType (Optional[str], optional): 阅读类型,可选DEFAULT,STREAM,PREAD. Defaults to None.</span>
<span class="sd">            limit (Optional[int], optional): 长度限制. Defaults to None.</span>
<span class="sd">            consistency (Optional[str], optional): 指定一致性,可选的有STRONG,TIMELINE. Defaults to None.</span>
<span class="sd">            targetReplicaId (Optional[int], optional): 指定副本丢失修复方法.. Defaults to None.</span>
<span class="sd">            filterBytes (Optional[bytes], optional): 过滤字节流. Defaults to None.</span>
<span class="sd">            rowNum (Optional[int], optional): 一次获取的行数量. Defaults to 20.</span>
<span class="sd">            columns_decoder (Optional[Mapping[str, Callable[[bytes, Optional[bytes]], Any]]], optional): _description_. Defaults to None.</span>

<span class="sd">        Raises:</span>
<span class="sd">            AttributeError: 表名格式不合法</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict[str, List[ColumnsValue]]: 结果字典</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># TScan</span>
        <span class="k">if</span> <span class="n">ns</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tableNameInbytes</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ns</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tabelinfo</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tabelinfo</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">tableNameInbytes</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;parameter table syntax error: </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">scan_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">columns</span><span class="p">:</span>
            <span class="n">scan_dict</span><span class="p">[</span><span class="s2">&quot;columns&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">TColumn</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">qualifier</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">else</span> <span class="n">TColumn</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">caching</span><span class="p">:</span>
            <span class="n">scan_dict</span><span class="p">[</span><span class="s2">&quot;caching&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">caching</span>
        <span class="k">if</span> <span class="n">maxVersions</span><span class="p">:</span>
            <span class="n">scan_dict</span><span class="p">[</span><span class="s2">&quot;maxVersions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">maxVersions</span>
        <span class="k">if</span> <span class="n">timeRange</span><span class="p">:</span>
            <span class="n">scan_dict</span><span class="p">[</span><span class="s2">&quot;timeRange&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">TTimeRange</span><span class="p">(</span>
                <span class="n">minStamp</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">timeRange</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">timestamp</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">),</span>
                <span class="n">maxStamp</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">timeRange</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">timestamp</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">filterString</span><span class="p">:</span>
            <span class="n">scan_dict</span><span class="p">[</span><span class="s2">&quot;filterString&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filterString</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">attributes</span><span class="p">:</span>
            <span class="n">scan_dict</span><span class="p">[</span><span class="s2">&quot;attributes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">):</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">attributes</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
        <span class="k">if</span> <span class="n">authorizations</span><span class="p">:</span>
            <span class="n">scan_dict</span><span class="p">[</span><span class="s2">&quot;authorizations&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">TAuthorization</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="n">authorizations</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">reversed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">scan_dict</span><span class="p">[</span><span class="s2">&quot;reversed&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">reversed</span>
        <span class="k">if</span> <span class="n">cacheBlocks</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">scan_dict</span><span class="p">[</span><span class="s2">&quot;cacheBlocks&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cacheBlocks</span>
        <span class="k">if</span> <span class="n">colFamTimeRangeMap</span><span class="p">:</span>
            <span class="n">scan_dict</span><span class="p">[</span><span class="s2">&quot;colFamTimeRangeMap&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">):</span> <span class="n">TTimeRange</span><span class="p">(</span>
                <span class="n">minStamp</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">timestamp</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">),</span>
                <span class="n">maxStamp</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">timestamp</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">))</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">colFamTimeRangeMap</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
        <span class="k">if</span> <span class="n">readType</span><span class="p">:</span>
            <span class="n">scan_dict</span><span class="p">[</span><span class="s2">&quot;readType&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">TReadType</span><span class="o">.</span><span class="n">_NAMES_TO_VALUES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">readType</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">consistency</span><span class="p">:</span>
            <span class="n">scan_dict</span><span class="p">[</span><span class="s2">&quot;consistency&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">TConsistency</span><span class="o">.</span><span class="n">_NAMES_TO_VALUES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">consistency</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">targetReplicaId</span><span class="p">:</span>
            <span class="n">scan_dict</span><span class="p">[</span><span class="s2">&quot;targetReplicaId&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">targetReplicaId</span>
        <span class="k">if</span> <span class="n">filterBytes</span><span class="p">:</span>
            <span class="n">scan_dict</span><span class="p">[</span><span class="s2">&quot;filterBytes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filterBytes</span>
        <span class="k">if</span> <span class="n">batchSize</span><span class="p">:</span>
            <span class="n">scan_dict</span><span class="p">[</span><span class="s2">&quot;batchSize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">batchSize</span>
        <span class="k">if</span> <span class="n">limit</span><span class="p">:</span>
            <span class="n">scan_dict</span><span class="p">[</span><span class="s2">&quot;limit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">limit</span>
        <span class="k">if</span> <span class="n">startRow</span><span class="p">:</span>
            <span class="n">scan_dict</span><span class="p">[</span><span class="s2">&quot;startRow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">startRow</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">stopRow</span><span class="p">:</span>
            <span class="n">scan_dict</span><span class="p">[</span><span class="s2">&quot;stopRow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">stopRow</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">lastResult</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="c1"># getScannerResults会自动完成open,close 等scanner操作，HBase增强版必须使用此方法进行范围扫描</span>
            <span class="n">currentResults</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">getScannerResults</span><span class="p">(</span>
                <span class="n">table</span><span class="o">=</span><span class="n">tableNameInbytes</span><span class="p">,</span>
                <span class="n">tscan</span><span class="o">=</span><span class="n">TScan</span><span class="p">(</span><span class="o">**</span><span class="n">scan_dict</span><span class="p">),</span>
                <span class="n">numRows</span><span class="o">=</span><span class="n">rowNum</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">currentResults</span><span class="p">:</span>
                <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
                <span class="n">lastResult</span> <span class="o">=</span> <span class="n">result</span>
            <span class="c1"># 如果一行都没有扫描出来，说明扫描已经结束，我们已经获得startRow和stopRow之间所有的result</span>
            <span class="k">if</span> <span class="n">lastResult</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="c1"># 如果此次扫描是有结果的，我们必须构造一个比当前最后一个result的行大的最小row，继续进行扫描，以便返回所有结果</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">nextStartRow</span> <span class="o">=</span> <span class="n">_createClosestRowAfter</span><span class="p">(</span><span class="n">lastResult</span><span class="o">.</span><span class="n">row</span><span class="p">)</span>
                <span class="n">scan_dict</span><span class="p">[</span><span class="s2">&quot;startRow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nextStartRow</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
            <span class="n">row_key</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">row</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">tcv</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">columnValues</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">columns_decoder</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">family</span> <span class="o">=</span> <span class="n">tcv</span><span class="o">.</span><span class="n">family</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
                    <span class="n">col</span> <span class="o">=</span> <span class="n">tcv</span><span class="o">.</span><span class="n">qualifier</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
                    <span class="n">col_name</span> <span class="o">=</span> <span class="n">fullcolumn</span><span class="p">(</span><span class="n">family</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
                    <span class="n">decoder</span> <span class="o">=</span> <span class="n">columns_decoder</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span>
                    <span class="c1"># cv.regist_decoder(decoder)</span>
                    <span class="n">cv</span> <span class="o">=</span> <span class="n">ColumnsValue</span><span class="p">(</span><span class="n">decoder</span><span class="o">=</span><span class="n">decoder</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">cv</span> <span class="o">=</span> <span class="n">ColumnsValue</span><span class="p">()</span>
                <span class="n">cv</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">tcv</span><span class="p">)</span>
                <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cv</span><span class="p">)</span>
            <span class="n">res</span><span class="p">[</span><span class="n">row_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span>
        <span class="k">return</span> <span class="n">res</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; 版权所有 2022, hsz.

    </p>
  </div>
    
    
    
    利用 <a href="https://www.sphinx-doc.org/">Sphinx</a> 构建，使用了 
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">主题</a>
    
    由 <a href="https://readthedocs.org">Read the Docs</a>开发. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>